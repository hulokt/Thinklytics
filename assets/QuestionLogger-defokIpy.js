import{j as e,a2 as t,m as r,A as s,o as a,al as n,Y as i}from"./ui-libs-CDpwxd4y.js";import{r as o}from"./react-vendor-Bmnvhqav.js";import{b as l,D as d,S as c,c as u,d as m,f as x,e as g,h,g as p,A as b,P as f,I as y,i as w,j as v,k as j,l as k,M as N,R as C}from"./index-CumCRn_F.js";import{F as T}from"./data-libs-DQyM0wFE.js";import"./supabase-X-pkD9a7.js";import"./pdf-utils-CIzaveRM.js";const S=({children:s,delay:a=0,index:n,onMouseEnter:i,onClick:l})=>{const d=o.useRef(null),c=t(d,{amount:.5});return e.jsx(r.div,{ref:d,"data-index":n,onMouseEnter:i,onClick:l,initial:{scale:.7,opacity:0},animate:c?{scale:1,opacity:1}:{scale:.7,opacity:0},transition:{duration:.2,delay:a},style:{marginBottom:"1rem",cursor:"pointer"},children:s})},q=({items:t=[],onItemSelect:r,showGradients:s=!0,enableArrowNavigation:a=!0,className:n="",itemClassName:i="",displayScrollbar:l=!0,initialSelectedIndex:d=-1,selectedItems:c=new Set,disabled:u=!1})=>{const m=o.useRef(null),[x,g]=o.useState(d),[h,p]=o.useState(-1),[b,f]=o.useState(!1),[y,w]=o.useState(0),[v,j]=o.useState(1),[k,N]=o.useState(!1),[C,T]=o.useState(10),[q,A]=o.useState(!1);o.useEffect(()=>{const e=()=>{A(window.innerWidth<=768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),o.useEffect(()=>{T(10)},[t]),o.useEffect(()=>{g(d)},[d]);const I=q?t.slice(0,C):t,E=q&&C<t.length;return o.useEffect(()=>{if(!a||!k)return;const e=e=>{"ArrowDown"===e.key||"Tab"===e.key&&!e.shiftKey?(e.preventDefault(),f(!0),p(e=>Math.min(e+1,t.length-1))):"ArrowUp"===e.key||"Tab"===e.key&&e.shiftKey?(e.preventDefault(),f(!0),p(e=>Math.max(e-1,0))):"Enter"===e.key&&h>=0&&h<t.length&&(e.preventDefault(),g(h),r&&r(t[h],h))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[t,h,r,a,k]),o.useEffect(()=>{if(!b||h<0||!m.current)return;const e=m.current,t=e.querySelector(`[data-index="${h}"]`);if(t){const r=50,s=e.scrollTop,a=e.clientHeight,n=t.offsetTop,i=n+t.offsetHeight;n<s+r?e.scrollTo({top:n-r,behavior:"smooth"}):i>s+a-r&&e.scrollTo({top:i-a+r,behavior:"smooth"})}f(!1)},[h,b]),e.jsxs("div",{className:`scroll-list-container ${n}`,children:[e.jsxs("div",{ref:m,className:"scroll-list "+(l?"":"no-scrollbar"),onScroll:e=>{const{scrollTop:t,scrollHeight:r,clientHeight:s}=e.target;w(Math.min(t/50,1));const a=r-(t+s);j(r<=s?0:Math.min(a/50,1))},onFocus:()=>N(!0),onBlur:()=>N(!1),onMouseEnter:()=>N(!0),onMouseLeave:()=>{N(!1),p(-1)},tabIndex:0,children:[I.map((t,s)=>{const a=c.has(s);return e.jsx(S,{delay:.1,index:s,onMouseEnter:()=>!u&&p(s),onClick:()=>{u||(g(s),r&&r(t,s))},children:e.jsx("div",{className:`item ${x===s?"selected":""} ${h===s?"hovered":""} ${a?"bulk-selected":""} ${i}`,children:e.jsx("p",{className:"item-text",children:t})})},s)}),E&&e.jsxs("div",{className:"flex flex-col gap-2 mt-4 p-2",children:[e.jsxs("button",{onClick:()=>{T(e=>Math.min(e+10,t.length))},className:"w-full px-4 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-medium transition-colors duration-200 text-sm",children:["Load More Questions (",Math.min(10,t.length-C)," more)"]}),e.jsxs("button",{onClick:()=>{T(t.length)},className:"w-full px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg font-medium transition-colors duration-200 text-xs",children:["Show All (",t.length," total)"]})]})]}),s&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"top-gradient",style:{opacity:y}}),e.jsx("div",{className:"bottom-gradient",style:{opacity:v}})]})]})},A=({children:t,onClick:l,className:d="",type:c="button",variant:u="primary",successMessage:m,disabled:x=!1})=>{const[g,h]=o.useState(!1),[p,b]=o.useState(!1),[f,y]=o.useState("");return e.jsx(r.button,{type:c,onClick:async e=>{if(x||g)return;h(!0);const t="function"==typeof m?m():m||"Success!";y(t);try{await l(e),b(!0),setTimeout(()=>{b(!1),h(!1),y("")},1500)}catch(r){h(!1),y("")}},disabled:x||g,className:`\n        relative overflow-hidden px-6 py-2 rounded-lg font-medium transition-all duration-200\n        ${(()=>{switch(u){case"primary":default:return"bg-blue-600 hover:bg-blue-700 text-white";case"danger":return"bg-red-600 hover:bg-red-700 text-white";case"success":return"bg-green-600 hover:bg-green-700 text-white"}})()}\n        ${x?"opacity-50 cursor-not-allowed":""}\n        ${d}\n      `,whileHover:x||g?{}:{scale:1.02},whileTap:x||g?{}:{scale:.98},children:e.jsx(s,{mode:"wait",children:p?e.jsxs(r.div,{initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.5},transition:{type:"spring",stiffness:500,damping:30},className:"flex items-center justify-center space-x-2",children:[(()=>{switch(u){case"danger":return e.jsx(i,{className:"w-4 h-4"});case"primary":return e.jsx(n,{className:"w-4 h-4"});default:return e.jsx(a,{className:"w-4 h-4"})}})(),e.jsx("span",{children:f})]},"success"):g?e.jsxs(r.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex items-center justify-center space-x-2",children:[e.jsx(r.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full"}),e.jsx("span",{children:"Processing..."})]},"loading"):e.jsx(r.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex items-center justify-center space-x-2",children:t},"default")})})},I=(e="",t="")=>{const r=e.length,s=t.length;if(0===r)return s;if(0===s)return r;const a=Array.from({length:r+1},()=>new Array(s+1));for(let n=0;n<=r;n++)a[n][0]=n;for(let n=0;n<=s;n++)a[0][n]=n;for(let n=1;n<=r;n++)for(let r=1;r<=s;r++){const s=e[n-1]===t[r-1]?0:1;a[n][r]=Math.min(a[n-1][r]+1,a[n][r-1]+1,a[n-1][r-1]+s)}return a[r][s]},E=(e,t,r=.45)=>{const s=(e||"").toLowerCase().replace(/[^a-z\s&+/]/g,"").trim();let a=null,n=0;for(const i of t){const e=1-I(s,i.toLowerCase())/Math.max(s.length||1,i.length);e>n&&(n=e,a=i)}return n>=r?a:null},M=({questions:t,loading:r=!1,onAddQuestion:s,onUpdateQuestion:a,onDeleteQuestion:n,onBulkDeleteQuestions:i})=>{const S=Array.isArray(t)?t:[],{user:I}=l(),[M,L]=o.useState({show:!1,points:0,action:""}),[D,$]=o.useState(null),[B,P]=o.useState(null),[Q,W]=o.useState({section:c.READING_WRITING,domain:"",questionType:"",passageText:"",passageImage:null,questionText:"",answerChoices:{A:"",B:"",C:"",D:""},correctAnswer:"A",explanation:"",explanationImage:null,difficulty:d.MEDIUM}),[O,R]=o.useState(null),[F,z]=o.useState(null),[H,_]=o.useState("All Sections"),[U,V]=o.useState(""),[G,Y]=o.useState({}),[K,J]=o.useState(!1),[X,Z]=o.useState(""),[ee,te]=o.useState(""),[re,se]=o.useState(!1),[ae,ne]=o.useState(!1),[ie,oe]=o.useState(!1),[le,de]=o.useState(!1),[ce,ue]=o.useState([]),[me,xe]=o.useState(0),[ge,he]=o.useState(!1),[pe,be]=o.useState({total:0,completed:0}),[fe,ye]=o.useState(!1),[we,ve]=o.useState(!1),[je,ke]=o.useState([]),[Ne,Ce]=o.useState({}),[Te,Se]=o.useState(new Set),[qe,Ae]=o.useState(!1),[Ie,Ee]=o.useState(!1),[Me,Le]=o.useState(-1),[De,$e]=o.useState(new Date),[Be,Pe]=o.useState({isOpen:!1,imageSrc:"",imageAlt:""});o.useEffect(()=>{},[je]),o.useEffect(()=>{const e=setInterval(()=>{$e(new Date)},6e4);return()=>clearInterval(e)},[]),o.useEffect(()=>{const e=new Audio(u);e.volume=.4,$(e);const t=new Audio(m);return t.volume=.4,P(t),()=>{e&&e.pause(),t&&t.pause()}},[]);const Qe=async(e,t={})=>{if(I?.id)try{const r=await k(I.id,e,t);r.success&&0!==r.pointsAwarded&&L({show:!0,points:r.pointsAwarded,action:e})}catch(r){}},We=(e,t)=>{W(r=>{const s={...r,[e]:t};return"domain"===e&&(s.questionType=""),s}),G[e]&&Y(t=>({...t,[e]:!1}))},Oe=async e=>{e.preventDefault();const t=(()=>{if(!Q.section||!Q.domain||!Q.questionType)return!1;const e=!Q.passageText||""===Q.passageText.trim(),t=!Q.passageImage,r=!Q.questionText||""===Q.questionText.trim(),s=!Q.explanation||""===Q.explanation.trim(),a=!Q.answerChoices||Object.values(Q.answerChoices).every(e=>!e||""===e.trim());return e&&t&&r&&s&&a})(),r={};if(Q.section||(r.section=!0),Q.section!==c.MATH&&(Q.domain||(r.domain=!0),Q.questionType||(r.questionType=!0)),!t)if(Q.passageText.trim()||Q.passageImage||(r.passageText=!0),Q.section===c.MATH||Q.questionText.trim()||(r.questionText=!0),Q.section===c.MATH){["A","B","C","D"].forEach((e,t)=>{Q.answerChoices[e]&&""!==Q.answerChoices[e].trim()||(Q.answerChoices[e]=e)})}else{const e=Object.entries(Q.answerChoices).filter(([e,t])=>!t.trim()).map(([e])=>e);e.length>0&&e.forEach(e=>{r[`answerChoice_${e}`]=!0})}if(Object.keys(r).length>0)throw Y(r),new Error("Validation failed");Y({}),O?(a(O,Q),v(),D&&(D.currentTime=0,D.play().catch(e=>{})),Qe("EDIT_QUESTION").catch(e=>{}),R(null),z(null),Le(-1)):(s(Q),D&&(D.currentTime=0,D.play().catch(e=>{})),Qe("ADD_QUESTION").catch(e=>{})),ge||W({section:Q.section,domain:"",questionType:"",passageText:"",passageImage:null,questionText:"",answerChoices:{A:"",B:"",C:"",D:""},correctAnswer:"A",explanation:"",explanationImage:null,difficulty:d.MEDIUM})},Re={includeScore:!0,shouldSort:!1,threshold:.3,ignoreLocation:!0,minMatchCharLength:2,keys:[{name:"section",weight:.3},{name:"domain",weight:.3},{name:"questionType",weight:.3},{name:"difficulty",weight:.3},{name:"correctAnswer",weight:.4},{name:"questionText",weight:.2},{name:"passageText",weight:.15},{name:"answerChoices.A",weight:.05},{name:"answerChoices.B",weight:.05},{name:"answerChoices.C",weight:.05},{name:"answerChoices.D",weight:.05},{name:"explanation",weight:.05}]};o.useMemo(()=>new T(S,Re),[S]);const Fe=o.useMemo(()=>{let e=[...t];const r=U.trim().toLowerCase();r.includes("hidden")||(e=e.filter(e=>!e.hidden)),r&&(e=e.filter(e=>[e.section,e.domain,e.questionType,e.questionText,e.explanation,e.hidden?"hidden":""].join(" ").toLowerCase().includes(r)));const s=e=>{const t=e.createdAt||e.date||e.lastUpdated||0,r=new Date(t).getTime();return Number.isNaN(r)?0:r};return e.sort((e,t)=>{const r=s(t)-s(e);return 0!==r?r:"number"==typeof t.id&&"number"==typeof e.id?t.id-e.id:0})},[t,U]),ze=o.useMemo(()=>Fe.map(e=>{const t=(e.passageText||"").trim().split(/\s+/),r=t.slice(0,5).join(" "),s=r&&r.length>0?`${r}${t.length>5?"...":""}`:"No passage text",a=e.hidden?" ðŸ”’":"",n=e.createdAt||e.lastUpdated?` â€¢ ${x(e.createdAt||e.lastUpdated)}`:"";return`${e.section} | ${s}${a}${n}`}),[Fe,De]),He=e=>{const t=new Set(Te);t.has(e)?t.delete(e):t.add(e),Se(t)},_e=e=>{try{const t=(e=>{const t=[];let r="",s=!1;for(let a=0;a<e.length;a++){const n=e[a];'"'===n?s=!s:","!==n||s?r+=n:(t.push(r.trim()),r="")}return t.push(r.trim()),t.map(e=>e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e)})(e);if(t.length<3)throw new Error(`CSV must have at least 3 fields for hidden questions or 11+ fields for complete questions. Found ${t.length} fields.`);const r=t[0],s=t[1],a=t[2],n=(e=>{const t=Object.values(c);return E(e,t,.3)||c.READING_WRITING})(r),i=((e,t)=>{const r=t===c.MATH?Object.values(N):[...Object.values(C),...Object.values(N)];return E(e,r,.35)||(t===c.MATH?"Algebra":"Information and Ideas")})(s,n),o=(e=>{const t={"main idea":"Main Idea",inference:"Inferences",inferences:"Inferences","supporting evidence":"Supporting Evidence",detail:"Detail","central ideas and details":"Central Ideas and Details","command of evidence":"Command of Evidence","words in context":"Words in Context","text structure":"Text Structure","text structure and purpose":"Text Structure and Purpose",purpose:"Purpose","cross-text connections":"Cross-Text Connections","structure and purpose":"Structure and Purpose","rhetorical synthesis":"Rhetorical Synthesis",transitions:"Transitions",conciseness:"Conciseness",precision:"Precision","modifier placement":"Modifier Placement","logical comparison":"Logical Comparison",punctuation:"Punctuation","sentence boundaries":"Sentence Boundaries","verb tense and agreement":"Verb Tense and Agreement","pronouns and modifiers":"Pronouns and Modifiers","punctuation usage":"Punctuation Usage",boundaries:"Boundaries","form structure and sense":"Form, Structure, and Sense","linear equations":"Linear equations in one variable","linear functions":"Linear functions","linear equations in two variables":"Linear equations in two variables","systems of two linear equations in two variables":"Systems of two linear equations in two variables","linear inequalities in one or two variables":"Linear inequalities in one or two variables",inequalities:"Linear inequalities in one or two variables","systems of equations":"Systems of two linear equations in two variables","linear/quadratic equations":"Linear equations in one variable",quadratics:"Nonlinear functions","rational expressions":"Equivalent expressions","radical equations":"Nonlinear equations in one variable and systems of equations in two variables",functions:"Nonlinear functions","nonlinear functions":"Nonlinear functions","nonlinear equations":"Nonlinear equations in one variable and systems of equations in two variables","equivalent expressions":"Equivalent expressions","ratios and proportions":"Ratios, rates, proportional relationships, and units","unit conversions":"Ratios, rates, proportional relationships, and units","data interpretation":"One-variable data: Distributions and measures of center and spread",statistics:"One-variable data: Distributions and measures of center and spread",percentages:"Percentages",probability:"Probability and conditional probability",scatterplots:"Two-variable data: Models and scatterplots","inference from sample statistics":"Inference from sample statistics and margin of error","evaluating statistical claims":"Evaluating statistical claims: Observational studies and experiments",angles:"Lines, angles, and triangles",circles:"Circles","area/volume":"Area and volume","trigonometric functions":"Right triangles and trigonometry",geometry:"Lines, angles, and triangles",trigonometry:"Right triangles and trigonometry","right triangles":"Right triangles and trigonometry","lines angles and triangles":"Lines, angles, and triangles","area and volume":"Area and volume",linear:"Linear equations in one variable",quadratic:"Nonlinear functions",ratio:"Ratios, rates, proportional relationships, and units",proportion:"Ratios, rates, proportional relationships, and units",data:"One-variable data: Distributions and measures of center and spread",statistical:"One-variable data: Distributions and measures of center and spread",geometric:"Lines, angles, and triangles",trig:"Right triangles and trigonometry",trigonometric:"Right triangles and trigonometry",word:"Words in Context",context:"Words in Context",sentence:"Boundaries",boundary:"Boundaries",verb:"Form, Structure, and Sense",agreement:"Form, Structure, and Sense",pronoun:"Form, Structure, and Sense",modifier:"Form, Structure, and Sense",transition:"Transitions",synthesis:"Rhetorical Synthesis",rhetorical:"Rhetorical Synthesis",main:"Main Idea",idea:"Main Idea",evidence:"Supporting Evidence",supporting:"Supporting Evidence",structure:"Text Structure",text:"Text Structure",cross:"Cross-Text Connections",connection:"Cross-Text Connections","command evidence":"Command of Evidence"},r=((e="")=>e.replace(/[\u0000-\u001F\u007F-\u009F]/g,"").replace(/\s+/g," ").trim())(e).toLowerCase().replace(/[^a-z\s-]/g,"").trim();if(t[r])return t[r];if(r.endsWith("s")){const e=r.slice(0,-1);if(t[e])return t[e]}if(r.includes("command of evidence"))return"Command of Evidence";if(r.includes("text structure")&&r.includes("purpose"))return"Text Structure and Purpose";if(r.includes("cross-text"))return"Cross-Text Connections";if(r.includes("central ideas"))return"Central Ideas and Details";if(r.includes("words in context"))return"Words in Context";if(r.includes("inference"))return"Inference";const s=[...new Set(Object.values(t))];return E(r,s,.3)||"Words in Context"})(a);if(3===t.length)return{section:n,domain:i,questionType:o,passageText:"",questionText:"",answerChoices:{A:"",B:"",C:"",D:""},correctAnswer:"A",explanation:"",explanationImage:null,difficulty:d.MEDIUM};if(t.length<11)throw new Error(`CSV must have at least 11 fields for complete questions. Found ${t.length} fields.`);const[,,,l,u,m,x,g,h,p,b,f]=t,y={easy:"Easy",ez:"Easy",eazy:"Easy",easyyy:"Easy",medium:"Medium",med:"Medium",meh:"Medium",hard:"Hard",hrd:"Hard",difficult:"Hard"}[(f||"").toLowerCase().replace(/[^a-z]/g,"").trim()]||"Medium",w=(p||"A").toUpperCase().replace(/[^ABCD]/g,"A");let v=l||"",j=null;const k="[IMAGE_DATA]",T="[/IMAGE_DATA]";if(v.includes(k)&&v.includes(T)){const e=v.indexOf(k),t=v.indexOf(T)+T.length,r=v.substring(e,t).replace(k,"").replace(T,"");r.startsWith("data:image/")&&(j=r),v=v.substring(0,e)+v.substring(t),v=v.trim()}let S=b||"",q=null;if(S.includes(k)&&S.includes(T)){const e=S.indexOf(k),t=S.indexOf(T)+T.length,r=S.substring(e,t).replace(k,"").replace(T,"");r.startsWith("data:image/")&&(q=r),S=S.substring(0,e)+S.substring(t),S=S.trim()}return{section:n,domain:i,questionType:o,passageText:v,passageImage:j,questionText:u||"",answerChoices:{A:m||"",B:x||"",C:g||"",D:h||""},correctAnswer:w,explanation:S,explanationImage:q,difficulty:y}}catch(t){throw new Error(`CSV parsing error: ${t.message}`)}},Ue=async()=>{if(!Ie)try{const e=(()=>{if(!Q.section||!Q.domain||!Q.questionType)return!1;const e=!Q.passageText||""===Q.passageText.trim(),t=!Q.passageImage,r=!Q.questionText||""===Q.questionText.trim(),s=!Q.explanation||""===Q.explanation.trim(),a=Object.values(Q.answerChoices).every(e=>!e||""===e.trim());return e&&t&&r&&s&&a})(),t={};if(Q.section||(t.section=!0),Q.domain||(t.domain=!0),Q.questionType||(t.questionType=!0),!e){Q.passageText.trim()||Q.passageImage||(t.passageText=!0),Q.questionText.trim()||(t.questionText=!0);const e=Object.entries(Q.answerChoices).filter(([e,t])=>!t.trim()).map(([e])=>e);e.length>0&&e.forEach(e=>{t[`answerChoice_${e}`]=!0})}if(Object.keys(t).length>0)return void Y(t);Y({}),Ce(e=>({...e,[me]:{...Q}}));const r=me+1;if(r<ce.length){ke(e=>[...e,{...Q}]),xe(r);const e=Ne[r]||ce[r];W(e),be(e=>({...e,completed:e.completed+1}))}else Ee(!0),ke(e=>{const t=[...e,{...Q}];return s(t),he(!1),ue([]),xe(0),be({total:0,completed:0}),Ce({}),L({show:!0,points:10*t.length,action:"BULK_IMPORT"}),setTimeout(()=>Ee(!1),3e3),[]})}catch(e){}},Ve=(e,t)=>{Pe({isOpen:!0,imageSrc:e,imageAlt:t})};return e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-blue-50 dark:from-gray-900 dark:to-blue-900 h-full overflow-hidden flex flex-col transition-colors duration-300",children:[e.jsx("div",{className:"bg-white/80 dark:bg-gray-900/80 backdrop-blur-md border-b border-gray-200/50 dark:border-gray-700/50 px-6 py-4 flex-shrink-0 relative overflow-hidden shadow-lg transition-colors duration-300",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2 md:gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-2xl font-bold text-gray-900 dark:text-white",children:ge?`Importing Questions (${me+1}/${pe.total})`:O?"Edit Question":"Create New Question"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-xs md:text-sm mt-1 transition-colors duration-300",children:ge?`Question ${me+1} of ${pe.total} - ${pe.completed} completed`:O?"Update the question details below with modern tools":"Add a new question to your question bank with advanced features"}),ge&&e.jsx("div",{className:"mt-2 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-green-400 to-blue-500 h-2 rounded-full transition-all duration-300",style:{width:(me+1)/pe.total*100+"%"}})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row w-full md:w-auto items-stretch md:items-center gap-2 md:gap-3",children:[!O&&!ge&&e.jsxs("button",{onClick:()=>{J(!0),Z(""),te("")},className:"group relative bg-gradient-to-r from-green-500 to-blue-600 text-white px-4 py-2 rounded-xl hover:shadow-lg transition-all duration-300 hover:scale-105 flex items-center space-x-2 text-sm font-medium overflow-hidden w-full md:w-auto",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-green-600 to-blue-700 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsxs("div",{className:"relative flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("span",{children:"Paste CSV"})]})]}),ge&&e.jsxs("button",{onClick:()=>{ve(!0)},className:"group relative bg-gradient-to-r from-red-500 to-red-600 text-white px-4 py-2 rounded-xl hover:shadow-lg transition-all duration-300 hover:scale-105 flex items-center space-x-2 text-sm font-medium overflow-hidden w-full md:w-auto",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-600 to-red-700 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsxs("div",{className:"relative flex items-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),e.jsx("span",{children:"Cancel Import"})]})]})]})]})}),K&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-4 sm:p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto relative",children:[e.jsx("h3",{className:"text-lg font-bold mb-2 text-gray-900 dark:text-white",children:"Paste CSV to Fill Questions"}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-2",children:[e.jsx("strong",{children:"Complete questions:"})," Section, Domain, Question Type, Passage Text, Question Text, A, B, C, D, Correct (A/B/C/D), Explanation (optional), Difficulty"]}),e.jsxs("p",{className:"text-sm text-purple-600 dark:text-purple-400 mb-2",children:[e.jsx("strong",{children:"Hidden questions:"})," Section, Domain, Question Type (only 3 fields) - auto-detected as drafts"]}),e.jsxs("p",{className:"text-xs text-blue-600 dark:text-blue-400 mb-3",children:["ðŸ’¡ ",e.jsx("strong",{children:"Multi-question support:"})," Paste multiple questions by putting each question on a new line. You can import up to 100 questions at once!"]}),e.jsx("textarea",{className:"w-full border border-gray-300 dark:border-gray-600 rounded-lg p-2 mb-2 text-base sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none",rows:6,value:X,onChange:e=>Z(e.target.value),placeholder:'Example complete question:\nMath,Algebra,Linear/Quadratic Equations,"A company manufactures boxes with length 3 inches more than width! height 2 inches less than width.","What are the dimensions?","Width: 3 in! Length: 6 in! Height: 1 in","Width: 4 in! Length: 7 in! Height: 2 in","Width: 5 in! Length: 8 in! Height: 3 in","Width: 2 in! Length: 5 in! Height: 0 in",B,"Let w = width. Then length = w + 3! height = w - 2.",Medium\n\nExample hidden questions (only 3 fields):\nMath,Algebra,Linear/Quadratic Equations\nReading and Writing,Information and Ideas,Words in Context\nMath,Geometry and Trigonometry,Circles\n\nMixed import (complete + hidden questions):\nMath,Algebra,Linear/Quadratic Equations,"Full passage text","Full question?","Choice A","Choice B","Choice C","Choice D",A,"Full explanation",Easy\nMath,Problem Solving and Data Analysis,Statistics\nReading and Writing,Standard English Conventions,Boundaries'}),ee&&e.jsx("div",{className:"text-red-600 text-xs mb-2 bg-red-50 dark:bg-red-900/20 p-2 rounded border border-red-200 dark:border-red-800 whitespace-pre-line",children:ee}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2",children:[e.jsx("button",{onClick:()=>J(!1),className:"px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-500 text-sm w-full sm:w-auto",children:"Cancel"}),e.jsx("button",{onClick:()=>{te("");try{const e=(e=>{const t=e.trim().split("\n").filter(e=>""!==e.trim()),r=[];for(let s=0;s<t.length;s++){const e=s+1,a=t[s].trim();if(!a)continue;let n=0,i=!1;for(let t=0;t<a.length;t++){const e=a[t];'"'===e?i=!i:","!==e||i||n++}if(n++,n<3){const t=a.length>50?a.substring(0,50)+"...":a;r.push(`Line ${e}: Insufficient fields (${n}). Expected 3 for hidden questions or 11+ for complete questions. Preview: "${t}"`)}else if(n>3&&n<11){const t=a.length>50?a.substring(0,50)+"...":a;r.push(`Line ${e}: Incomplete fields (${n}). Expected either 3 for hidden questions or 11+ for complete questions. Preview: "${t}"`)}else if(n>12){const t=a.length>50?a.substring(0,50)+"...":a;r.push(`Line ${e}: Too many fields (${n}). Maximum 12 fields allowed. Preview: "${t}"`)}}return r})(X);if(e.length>0)return void te(`CSV Format Issues:\n${e.join("\n")}`);const t=(e=>{var t;const r=((t=e)?t.replace(/!/g,","):t).trim().split("\n").filter(e=>""!==e.trim()),s=[],a=e=>{let t=0,r=!1;for(let s=0;s<e.length;s++){const a=e[s];'"'===a?r=!r:","!==a||r||t++}return t++,t};for(let i=0;i<r.length;i++){const e=i+1,t=r[i].trim();if(t)try{const e=_e(t);s.push(e)}catch(n){const r=a(t);if(r<3){const s=t.length>100?t.substring(0,100)+"...":t;throw new Error(`Line ${e}: Insufficient question data. Found ${r} fields, expected 3 for hidden questions or 11+ for complete questions. Preview: "${s}"`)}if(r>3&&r<11){const s=t.length>100?t.substring(0,100)+"...":t;throw new Error(`Line ${e}: Incomplete question data. Found ${r} fields, expected either 3 for hidden questions or 11+ for complete questions. Preview: "${s}"`)}throw new Error(`Line ${e}: ${n.message}`)}}if(0===s.length)throw new Error("No valid questions found in CSV. Please check your format and ensure each line has all required fields.");if(s.length>100)throw new Error("Maximum 100 questions allowed per import");return s})(X);1===t.length?(W(t[0]),J(!1),Z("")):(ue(t),xe(0),W(t[0]),he(!0),be({total:t.length,completed:0}),Ce({}),J(!1),Z(""))}catch(e){te(e.message)}},className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium w-full sm:w-auto",children:"Import Questions"})]})]})}),fe&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 p-4",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-4 sm:p-6 w-full max-w-md relative",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-yellow-100 dark:bg-yellow-900/30 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-yellow-600 dark:text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("h3",{className:"text-lg font-bold mb-2 text-gray-900 dark:text-white",children:"Import in Progress"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-4",children:"You're currently importing questions. Please finish importing all questions before editing existing questions in your question bank."}),e.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 mb-4",children:"You can continue with the import or cancel it to return to normal editing mode."}),e.jsx("button",{onClick:()=>ye(!1),className:"px-6 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium w-full sm:w-auto",children:"Continue Import"})]})})}),we&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 p-4",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-4 sm:p-6 w-full max-w-md relative",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("h3",{className:"text-lg font-bold mb-2 text-gray-900 dark:text-white",children:"Cancel Import?"}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-4",children:["Are you sure you want to cancel the import? All questions you've reviewed (",pe.completed," questions) will be discarded and not added to your question bank."]}),e.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mb-4",children:"This action cannot be undone."}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-center space-y-2 sm:space-y-0 sm:space-x-3",children:[e.jsx("button",{onClick:()=>ve(!1),className:"px-6 py-2 rounded-lg bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-500 text-sm font-medium w-full sm:w-auto",children:"Continue Import"}),e.jsx("button",{onClick:()=>{he(!1),ue([]),xe(0),be({total:0,completed:0}),ke([]),Ce({}),ve(!1),W({section:c.READING_WRITING,domain:"",questionType:"",passageText:"",passageImage:null,questionText:"",answerChoices:{A:"",B:"",C:"",D:""},correctAnswer:"A",explanation:"",explanationImage:null,difficulty:d.MEDIUM})},className:"px-6 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700 text-sm font-medium w-full sm:w-auto",children:"Cancel Import"})]})]})})}),ie&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 p-4",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-4 sm:p-6 w-full max-w-md relative",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("h3",{className:"text-lg font-bold mb-2 text-gray-900 dark:text-white",children:"Export Questions"}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-2",children:["Choose your preferred export format for ",Fe.filter(e=>!e.hidden).length," visible questions."]}),e.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 mb-2",children:"Hidden questions will not be included in the export."}),e.jsx("p",{className:"text-xs text-green-600 dark:text-green-400 mb-6",children:"ðŸ’¡ CSV format: Section, Domain, Question Type, Passage Text, Question Text, A, B, C, D, Correct (A/B/C/D), Explanation, Difficulty. Images are embedded in passage text with special markers. Commas automatically converted to exclamation marks."}),e.jsxs("div",{className:"flex flex-col space-y-3",children:[e.jsxs("button",{onClick:async()=>{oe(!1),await(async()=>{const e=Fe.filter(e=>!e.hidden);se(!0),ne(!1);try{const t=await w(e,"Thinklytics_SAT_Question_Bank");if(!t.success)throw new Error(t.error);se(!1),ne(!0),setTimeout(()=>ne(!1),3e3)}catch(t){alert(`Error generating PDF: ${t.message}`),se(!1),ne(!1)}})()},disabled:re,className:"w-full px-6 py-3 rounded-lg bg-gradient-to-r from-red-500 to-red-600 text-white hover:from-red-600 hover:to-red-700 transition-all duration-300 hover:shadow-lg font-medium flex items-center justify-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("span",{children:"Export as PDF"})]}),e.jsx("button",{onClick:()=>{(async()=>{const e=Fe.filter(e=>!e.hidden);if(0===e.length)return void alert("No visible questions to copy!");const t=e=>{if(null==e)return"";let t=String(e).replace(/,/g,"!");return t=t.replace(/\r?\n/g," ").replace(/\s+/g," ").trim(),t=t.replace(/"/g,'""'),t=`"${t}"`,t},r=e.map(e=>{let r=e.passageText||"";if(e.passageImage){const t="[IMAGE_DATA]",s="[/IMAGE_DATA]";r=r.trim()?`${r} ${t}${e.passageImage}${s}`:`${t}${e.passageImage}${s}`}let s=e.explanation||"";if(e.explanationImage){const t="[IMAGE_DATA]",r="[/IMAGE_DATA]";s=s.trim()?`${s} ${t}${e.explanationImage}${r}`:`${t}${e.explanationImage}${r}`}return[t(e.section),t(e.domain),t(e.questionType),t(r),t(e.questionText||""),t(e.answerChoices?.A||""),t(e.answerChoices?.B||""),t(e.answerChoices?.C||""),t(e.answerChoices?.D||""),t(e.correctAnswer||"A"),t(s),t(e.difficulty||"Medium")].join(",")}).join("\n");try{await navigator.clipboard.writeText(r),de(!0),setTimeout(()=>{de(!1),oe(!1)},1500)}catch(s){const e=document.createElement("textarea");e.value=r,e.style.position="fixed",e.style.left="-999999px",e.style.top="-999999px",document.body.appendChild(e),e.focus(),e.select();try{document.execCommand("copy"),de(!0),setTimeout(()=>{de(!1),oe(!1)},1500)}catch(a){alert("Failed to copy CSV to clipboard. Please try again.")}document.body.removeChild(e)}})()},disabled:re||le,className:"w-full px-6 py-3 rounded-lg transition-all duration-300 hover:shadow-lg font-medium flex items-center justify-center space-x-2 "+(le?"bg-gradient-to-r from-blue-500 to-blue-600 text-white":"bg-gradient-to-r from-green-500 to-green-600 text-white hover:from-green-600 hover:to-green-700"),children:le?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e.jsx("span",{children:"Copied!"})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"})}),e.jsx("span",{children:"Copy CSV"})]})}),e.jsx("button",{onClick:()=>oe(!1),className:"w-full px-6 py-2 rounded-lg bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors font-medium",children:"Cancel"})]})]})})}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsx("div",{className:"w-full px-3 sm:px-6 py-4 lg:h-full pb-20 sm:pb-6",children:e.jsx("div",{className:"max-w-7xl mx-auto lg:h-full",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6 lg:h-full",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm rounded-2xl shadow-lg border border-gray-200/50 dark:border-gray-700/50 flex flex-col lg:h-full overflow-hidden hover:shadow-xl transition-all duration-300 relative min-h-[400px] md:min-h-[500px]",children:[e.jsx("div",{className:"p-4 sm:p-6 border-b border-gray-200/50 dark:border-gray-700/50 flex-shrink-0 transition-colors duration-300",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Question Details"}),ge&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-blue-100 dark:bg-blue-900/30 px-3 py-1 rounded-full",children:e.jsxs("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:["Question ",me+1," of ",pe.total]})}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[pe.completed," completed"]})]})]})}),e.jsxs("form",{onSubmit:Oe,className:"flex flex-col lg:h-full overflow-hidden",children:[e.jsxs("div",{className:"p-3 sm:p-4 space-y-3 flex-1 lg:overflow-y-auto",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3 transition-colors duration-300",children:["Section ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"relative flex flex-wrap gap-2 p-2 rounded-xl shadow-inner transition-colors duration-300 "+(G.section?"bg-gradient-to-r from-red-100 to-red-200 dark:from-red-900/30 dark:to-red-800/30 border-2 border-red-300 dark:border-red-600":"bg-gradient-to-r from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-600"),children:Object.values(c).map(t=>e.jsxs("button",{type:"button",onClick:()=>We("section",t),className:"relative px-3 sm:px-5 py-2 text-xs sm:text-sm font-medium rounded-lg transition-all duration-300 overflow-hidden "+(Q.section===t?"text-white shadow-lg transform scale-105":"text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-white/50 dark:hover:bg-gray-700/50 hover:shadow-md"),children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-[#22adff] to-[#3ab6ff] rounded-lg transition-all duration-500 ease-out "+(Q.section===t?"opacity-100":"opacity-0")}),e.jsx("span",{className:"relative z-10",children:t})]},t))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 transition-colors duration-300",children:["Domain ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:Q.domain,onChange:e=>We("domain",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 text-base sm:text-sm transition-colors duration-300 "+(G.domain?"border-red-500 focus:ring-red-500 focus:border-red-500 bg-red-50 dark:bg-red-900/20":"border-gray-300 dark:border-gray-600 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"),children:[e.jsx("option",{value:"",children:"Select Domain"}),g(Q.section).map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 transition-colors duration-300",children:["Question Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:Q.questionType,onChange:e=>We("questionType",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 text-base sm:text-sm transition-colors duration-300 "+(G.questionType?"border-red-500 focus:ring-red-500 focus:border-red-500 bg-red-50 dark:bg-red-900/20":"border-gray-300 dark:border-gray-600 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"),children:[e.jsx("option",{value:"",children:"Select Question Type"}),(Q.domain?h(Q.section,Q.domain):p(Q.section)).map(t=>{const r=t.split(" "),s=Q.section===c.MATH&&r.length>5?`${r.slice(0,5).join(" ")} ...`:t;return e.jsx("option",{value:t,children:s},t)})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 transition-colors duration-300",children:["Passage Text ",e.jsx("span",{className:"text-red-500",children:"*"})]}),Q.passageImage&&e.jsxs("div",{className:"mb-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-600",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Passage Image"}),e.jsx("button",{type:"button",onClick:()=>{W(e=>({...e,passageImage:null}))},className:"text-xs text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 hover:underline",children:"Remove Image"})]}),e.jsx("img",{src:Q.passageImage,alt:"Passage",className:"max-h-48 w-auto rounded shadow-sm border border-gray-200 dark:border-gray-600 cursor-pointer hover:opacity-90 transition-opacity duration-200",onClick:()=>Ve(Q.passageImage,"Passage")})]}),e.jsx("textarea",{value:Q.passageText,onChange:e=>We("passageText",e.target.value),onPaste:e=>{const t=e.clipboardData?.items;if(t)for(let r=0;r<t.length;r++){const s=t[r];if(-1!==s.type.indexOf("image")){const t=s.getAsFile(),r=new FileReader;return r.onload=e=>{W(t=>({...t,passageImage:e.target.result}))},r.readAsDataURL(t),void e.preventDefault()}}},placeholder:Q.passageImage?"Add text to accompany the image above... (or paste another image)":"Enter the reading passage or problem context... (or paste an image)",rows:Q.passageImage?2:3,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 resize-vertical text-base sm:text-sm transition-colors duration-300 "+(G.passageText?"border-red-500 focus:ring-red-500 focus:border-red-500 bg-red-50 dark:bg-red-900/20":"border-gray-300 dark:border-gray-600 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white")}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"ðŸ’¡ You can paste images (Ctrl+V) and add text to create rich passages with both visual and textual content."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 transition-colors duration-300",children:["Question ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:Q.questionText,onChange:e=>We("questionText",e.target.value),placeholder:"Enter the specific question being asked...",rows:2,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 resize-vertical text-base sm:text-sm transition-colors duration-300 "+(G.questionText?"border-red-500 focus:ring-red-500 focus:border-red-500 bg-red-50 dark:bg-red-900/20":"border-gray-300 dark:border-gray-600 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white")})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 transition-colors duration-300",children:["Answer Choices ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:b.map(t=>e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"border-2 rounded-lg p-4 transition-colors "+(G[`answerChoice_${t}`]?"border-red-500 bg-red-50 dark:bg-red-900/20":Q.correctAnswer===t?"border-green-500 bg-green-50 dark:bg-green-900/20":"border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500 bg-white dark:bg-gray-700"),children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx("input",{type:"radio",id:`correct-${t}`,name:"correctAnswer",value:t,checked:Q.correctAnswer===t,onChange:e=>We("correctAnswer",e.target.value),className:"w-4 h-4 text-green-600 border-gray-300 dark:border-gray-600 focus:ring-green-500 dark:bg-gray-700"}),e.jsxs("label",{htmlFor:`correct-${t}`,className:"ml-2 text-sm font-medium text-gray-900 dark:text-white transition-colors duration-300 cursor-pointer hover:text-green-600 dark:hover:text-green-400",children:["Choice ",t," ",Q.correctAnswer===t&&e.jsx("span",{className:"text-green-600 text-xs",children:"(Correct)"})]})]}),e.jsx("input",{type:"text",value:Q.answerChoices[t],onChange:e=>((e,t)=>{W(r=>({...r,answerChoices:{...r.answerChoices,[e]:t}}));const r=`answerChoice_${e}`;G[r]&&Y(e=>({...e,[r]:!1}))})(t,e.target.value),placeholder:`Enter answer choice ${t}...`,className:"w-full px-3 py-2.5 border rounded-md focus:ring-2 text-base transition-colors duration-300 "+(G[`answerChoice_${t}`]?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 dark:border-gray-600 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white")})]})},t))})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 transition-colors duration-300",children:"Explanation (Optional)"}),Q.explanationImage&&e.jsxs("div",{className:"mb-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-600",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Explanation Image"}),e.jsx("button",{type:"button",onClick:()=>{W(e=>({...e,explanationImage:null}))},className:"text-xs text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 hover:underline",children:"Remove Image"})]}),e.jsx("img",{src:Q.explanationImage,alt:"Explanation",className:"max-h-48 w-auto rounded shadow-sm border border-gray-200 dark:border-gray-600 cursor-pointer hover:opacity-90 transition-opacity duration-200",onClick:()=>Ve(Q.explanationImage,"Explanation")})]}),e.jsx("textarea",{value:Q.explanation,onChange:e=>We("explanation",e.target.value),onPaste:e=>{const t=e.clipboardData?.items;if(t)for(let r=0;r<t.length;r++){const s=t[r];if(-1!==s.type.indexOf("image")){const t=s.getAsFile(),r=new FileReader;return r.onload=e=>{W(t=>({...t,explanationImage:e.target.result}))},r.readAsDataURL(t),void e.preventDefault()}}},placeholder:Q.explanationImage?"Add text to accompany the explanation image above... (or paste another image)":"Provide an explanation for the correct answer... (or paste an image)",rows:Q.explanationImage?2:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-vertical text-base sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors duration-300"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"ðŸ’¡ You can paste images (Ctrl+V) and add text to create rich explanations with both visual and textual content."})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 transition-colors duration-300",children:"Difficulty Level"}),e.jsx("select",{value:Q.difficulty,onChange:e=>We("difficulty",e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-base sm:text-sm transition-colors duration-300",children:Object.values(d).map(t=>e.jsx("option",{value:t,children:t},t))})]})})]})]}),e.jsx("div",{className:"p-3 sm:p-4 border-t border-gray-200 dark:border-gray-700 flex-shrink-0 transition-colors duration-300",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between gap-2",children:[O&&e.jsx("button",{type:"button",onClick:()=>{R(null),z(null),Le(-1),W({section:c.READING_WRITING,domain:"",questionType:"",passageText:"",passageImage:null,questionText:"",answerChoices:{A:"",B:"",C:"",D:""},correctAnswer:"A",explanation:"",explanationImage:null,difficulty:d.MEDIUM})},className:"bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors text-sm font-medium",children:"Cancel"}),ge&&e.jsxs("button",{type:"button",onClick:()=>{if(!ge)return;Ce(e=>({...e,[me]:{...Q}}));const e=me-1;if(e>=0){ke(e=>e.slice(0,-1)),be(e=>({...e,completed:Math.max(0,e.completed-1)})),xe(e);const t=Ne[e]||ce[e];W(t)}},disabled:0===me,className:"px-4 py-2 rounded-lg transition-colors text-sm font-medium flex items-center space-x-2 "+(0===me?"bg-gray-300 dark:bg-gray-700 text-gray-500 cursor-not-allowed":"bg-blue-200 dark:bg-blue-700 text-blue-800 dark:text-blue-200 hover:bg-blue-300 dark:hover:bg-blue-600"),children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),e.jsx("span",{children:"Previous"})]}),e.jsx("div",{className:O||ge?"":"sm:ml-auto",children:O&&!(()=>{if(!O||!F)return!1;const e=["section","domain","questionType","passageText","passageImage","questionText","correctAnswer","explanation","explanationImage","difficulty"];for(let t of e)if(Q[t]!==F[t])return!0;for(let t of["A","B","C","D"])if(Q.answerChoices[t]!==F.answerChoices[t])return!0;return!1})()?e.jsxs(A,{type:"button",variant:"danger",successMessage:"Question Deleted!",onClick:async()=>{await(async e=>{n(e),B&&(B.currentTime=0,B.play().catch(e=>{})),Qe("DELETE_QUESTION").catch(e=>{})})(O),R(null),z(null),Le(-1),W({section:c.READING_WRITING,domain:"",questionType:"",passageText:"",passageImage:null,questionText:"",answerChoices:{A:"",B:"",C:"",D:""},correctAnswer:"A",explanation:"",explanationImage:null,difficulty:d.MEDIUM})},className:"text-sm w-full sm:w-auto",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1-1H8a1 1 0 00-1 1v3M4 7h16"})}),e.jsx("span",{children:"Delete Question"})]}):ge?me===ce.length-1?e.jsx(A,{type:"button",variant:"success",successMessage:"Import Complete!",onClick:Ue,className:"text-sm flex items-center space-x-2 w-full sm:w-auto",children:e.jsx("span",{children:"Finish Import"})}):e.jsxs("button",{type:"button",onClick:Ue,className:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors text-sm flex items-center space-x-2 w-full sm:w-auto",children:[e.jsx("span",{children:"Next Question"}),e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}):e.jsx(A,{type:"button",variant:O?"primary":"success",successMessage:()=>O?"Updated!":"Added!",onClick:Oe,className:"text-sm w-full sm:w-auto",children:e.jsx("span",{children:O?"Update Question":"Add Question"})})})]})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 flex flex-col lg:h-full overflow-hidden transition-colors duration-300 min-h-[400px] md:min-h-[500px]",children:[e.jsx("div",{className:"p-3 sm:p-4 border-b border-gray-200 dark:border-gray-700 flex-shrink-0 transition-colors duration-300",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white transition-colors duration-300",children:"Question Bank"}),e.jsxs("div",{className:"flex items-center gap-3 text-sm transition-colors duration-300",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:ge?"Import in progress - editing disabled":(()=>{const e=Fe.filter(e=>!e.hidden);return Fe.filter(e=>e.hidden),`${e.length} questions`})()}),!ge&&(()=>{const t=Fe.filter(e=>e.hidden);return t.length>0?e.jsxs("p",{className:"text-gray-500 dark:text-gray-500 bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded text-xs",children:[t.length," hidden"]}):null})()]})]}),!ge&&Fe.length>0&&e.jsx("button",{onClick:()=>{Ae(!qe),qe&&Se(new Set)},disabled:ge,className:`px-4 py-2 text-sm rounded-lg transition-colors font-medium ${qe?"bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 hover:bg-purple-200 dark:hover:bg-purple-800/40 border border-purple-200 dark:border-purple-700":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 border border-gray-200 dark:border-gray-600"} ${ge?"opacity-50 cursor-not-allowed":""}`,children:qe?"Exit Selection":"Select Multiple"})]}),!ge&&qe&&Fe.length>0&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[e.jsx("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Bulk Selection Mode"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("button",{onClick:()=>{const e=Fe.map(e=>e.id);Se(new Set(e))},className:"px-3 py-1 text-xs bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-800/40 transition-colors font-medium",children:"Select All"}),e.jsx("button",{onClick:()=>{Se(new Set)},className:"px-3 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors font-medium",children:"Clear All"}),Te.size>0&&e.jsxs("button",{onClick:async()=>{if(0===Te.size)return;if(window.confirm(`Are you sure you want to delete ${Te.size} selected question${Te.size>1?"s":""}? This action cannot be undone.`))try{const t=Array.from(Te),r=t.length;if(B&&(B.currentTime=0,B.play().catch(e=>{})),i)i(t);else for(const e of t)n(e);Se(new Set),Ae(!1);const s=j.DELETE_QUESTION*r;if(L({show:!0,points:s,action:"DELETE_QUESTION"}),I?.id)for(let a=0;a<r;a++)try{k(I.id,"DELETE_QUESTION").catch(e=>{})}catch(e){}}catch(t){alert("Error deleting questions. Please try again.")}},className:"px-3 py-1 text-xs bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 rounded hover:bg-red-200 dark:hover:bg-red-800/40 transition-colors font-medium",children:["Delete Selected (",Te.size,")"]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:U,onChange:e=>V(e.target.value),disabled:ge,placeholder:"Search questions, sections, domains, or type 'hidden'...",className:"w-full pl-9 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-base sm:text-sm transition-colors duration-300 "+(ge?"opacity-50 cursor-not-allowed":"")}),e.jsx("svg",{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-4.35-4.35M4 10a6 6 0 1112 0 6 6 0 01-12 0z"})})]})]})}),e.jsx("div",{className:"p-3 sm:p-4 flex-1 lg:overflow-hidden",children:r?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-base font-medium text-gray-900 dark:text-white mb-1 transition-colors duration-300",children:"Loading questions..."})]}):0===Fe.length?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-3 transition-colors duration-300",children:e.jsx("svg",{className:"w-6 h-6 text-gray-400 dark:text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("h3",{className:"text-base font-medium text-gray-900 dark:text-white mb-1 transition-colors duration-300",children:"No questions found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm transition-colors duration-300",children:"Create your first question using the form."})]}):e.jsxs("div",{className:"lg:h-full relative",children:[e.jsx(q,{items:ze,onItemSelect:(e,t)=>{if(ge)return void ye(!0);const r=Fe[t];qe?He(r.id):((e,t=-1)=>{R(e.id),Le(t);const r={section:e.section,domain:e.domain,questionType:e.questionType,passageText:e.passageText,passageImage:e.passageImage||null,questionText:e.questionText,answerChoices:e.answerChoices,correctAnswer:e.correctAnswer,explanation:e.explanation,explanationImage:e.explanationImage||null,difficulty:e.difficulty};W(r),z(r)})(r,t)},showGradients:!0,enableArrowNavigation:!ge,displayScrollbar:!0,disabled:ge,initialSelectedIndex:Me,selectedItems:qe?new Set(Fe.map((e,t)=>Te.has(e.id)?t:-1).filter(e=>-1!==e)):new Set}),ge&&e.jsx("div",{className:"absolute inset-0 bg-white/90 dark:bg-gray-900/90 flex items-center justify-center rounded-lg z-10 border-2 border-yellow-300 dark:border-yellow-600",children:e.jsxs("div",{className:"text-center bg-white dark:bg-gray-800 p-4 rounded-lg shadow-lg border border-yellow-200 dark:border-yellow-700",children:[e.jsx("div",{className:"w-12 h-12 bg-yellow-100 dark:bg-yellow-900/30 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx("svg",{className:"w-6 h-6 text-yellow-600 dark:text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white mb-1",children:"Import in Progress"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Question bank editing disabled"})]})})]})}),Fe.length>0&&e.jsx("div",{className:"p-3 sm:p-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700/50 flex-shrink-0 transition-colors duration-300",children:e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between text-sm gap-2",children:e.jsx("span",{className:"text-gray-600 dark:text-gray-400 transition-colors duration-300",children:qe?`Click questions to select/deselect (${Te.size} selected)`:"Click any question to edit"})})})]})]})})})}),M.show&&e.jsx(f,{pointsAwarded:M.points,actionType:M.action,onComplete:()=>{L({show:!1,points:0,action:""})}}),e.jsx(y,{isOpen:Be.isOpen,imageSrc:Be.imageSrc,imageAlt:Be.imageAlt,onClose:()=>{Pe({isOpen:!1,imageSrc:"",imageAlt:""})}})]})};export{M as default};
