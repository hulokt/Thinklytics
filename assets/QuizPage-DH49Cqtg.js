import{j as e}from"./ui-libs-WBeOxq-T.js";import{r as t,u as r}from"./react-vendor-Bmnvhqav.js";import{c as n,d as s,a as o,b as a,Q as i,P as l,f as d,I as c}from"./index-BcWjTYQS.js";import"./supabase-BjlvUUcM.js";import"./pdf-utils-BVOYDPbl.js";import"./data-libs-DQyM0wFE.js";const x=({questions:x,onBack:m,isResuming:u=!1,initialQuizData:b=null})=>{const{soundEnabled:g}=n(),[h,f]=t.useState(0),[p,w]=t.useState({}),[k,y]=t.useState(!1),[v,j]=t.useState(null),[N,q]=t.useState(new Set),[C,S]=t.useState(!1),[A,z]=t.useState(!1),[E,I]=t.useState(0),[Q,_]=t.useState(Date.now()),[T,R]=t.useState(!1),[O,D]=t.useState(!1),[M,P]=t.useState(!1),[$,B]=t.useState(!1),[F,L]=t.useState(!1),[W,H]=t.useState({show:!1,points:0,action:""}),[U,V]=t.useState(!1),[Y,X]=t.useState({}),[G,J]=t.useState(!1),K=t.useRef(null),Z=t.useRef(null),[ee,te]=t.useState(new Set),[re,ne]=t.useState({}),[se,oe]=t.useState({isOpen:!1,imageSrc:"",imageAlt:""}),ae=t.useRef(null),ie=t.useRef({}),le=t.useRef(0),de=t.useRef(new Set),ce=t.useRef(0),xe=t.useRef(!1),me=t.useRef(!1),ue=t.useRef(!1),be=t.useRef(!1),ge=t.useRef({}),he=t.useRef(new Set),fe=t.useRef({}),pe=t.useRef(null),we=t.useRef(null),ke=t.useRef(null);t.useEffect(()=>{ae.current=v},[v]),t.useEffect(()=>{ie.current=p},[p]),t.useEffect(()=>{le.current=h},[h]),t.useEffect(()=>{de.current=N},[N]),t.useEffect(()=>{ce.current=E},[E]),t.useEffect(()=>{xe.current=k},[k]),t.useEffect(()=>{me.current=O},[O]),t.useEffect(()=>{ue.current=F},[F]),t.useEffect(()=>{be.current=U},[U]),t.useEffect(()=>{ge.current=Y},[Y]),t.useEffect(()=>{he.current=ee},[ee]),t.useEffect(()=>{fe.current=re},[re]);const{user:ye}=s(),ve=r(),{quizManager:je,allQuizzesLoading:Ne}=o(),{data:qe,upsertData:Ce}=a(),Se=e=>{g&&e.current&&(e.current.currentTime=0,e.current.play().catch(e=>{}))};t.useEffect(()=>{pe.current=new Audio("/assets/onclickV2-CW79yXce.mp3"),we.current=new Audio("/assets/correctChoicev2-CrhUSF-p.wav"),ke.current=new Audio("/assets/wrongChoiceSound-e1JTzZ7m.wav"),pe.current.volume=.5,we.current.volume=.5,ke.current.volume=.5},[]);const Ae=()=>{H({show:!1,points:0,action:""})};t.useEffect(()=>{if(u&&b){const e=b.timeSpent||0,t=Date.now();_(t-1e3*e),I(e)}else{const e=Date.now();_(e),I(0)}},[u,b]),t.useEffect(()=>{if(!v)return;const e=`satlog:quiz:${v.id}:startTime`,t=localStorage.getItem(e);if(t){const e=parseInt(t,10);if(!isNaN(e)){_(e);const t=Date.now();I(Math.floor((t-e)/1e3))}}},[v]),t.useEffect(()=>{v&&Q&&localStorage.setItem(`satlog:quiz:${v.id}:startTime`,String(Q))},[v,Q]),t.useEffect(()=>{if(k)return;const e=setInterval(()=>{const e=Date.now(),t=Math.floor((e-Q)/1e3);I(t),j(e=>e?{...e,timeSpent:t}:e)},1e3);return()=>clearInterval(e)},[Q,k]),t.useEffect(()=>()=>{const e=ae.current,t=ie.current,r=le.current,n=de.current,s=ce.current,o=xe.current,a=me.current,l=e?.status===i.COMPLETED;if(e&&e.questions&&!o&&!a&&!l&&(Object.keys(t).length>0||s>0)){const o={...e,userAnswers:t,currentQuestionIndex:r,flaggedQuestions:Array.from(n),eliminationMode:be.current,eliminatedOptions:ge.current,checkedQuestions:Array.from(he.current),showExplanation:fe.current,lastUpdated:(new Date).toISOString(),timeSpent:s};je&&je.saveQuiz(o).catch(e=>{}),e?.id&&localStorage.removeItem(`satlog:quiz:${e.id}:startTime`)}pe.current&&(pe.current.pause(),pe.current=null),we.current&&(we.current.pause(),we.current=null),ke.current&&(ke.current.pause(),ke.current=null)},[]);const ze=e=>{const t=e%60;return`${Math.floor(e/60).toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`},Ee=e=>{if(!e||"string"!=typeof e)return e;return e.replace(/^[A-Da-d]\)\s*/,"")},Ie=e=>!e.passageText&&e.questionText&&e.questionText.length>200?{...e,passageText:e.questionText,questionText:"Which choice completes the text with the most logical and precise word or phrase?",options:(e.options||Object.values(e.answerChoices||{})).map(Ee),correctAnswer:e.answerChoices?e.answerChoices[e.correctAnswer]:e.correctAnswer}:e.answerChoices&&!e.options?{...e,options:Object.values(e.answerChoices).map(Ee),correctAnswer:e.answerChoices[e.correctAnswer]||e.correctAnswer}:e.options?{...e,options:e.options.map(Ee)}:e,Qe=e=>{if(e.answerChoices&&e.correctAnswer){if(["A","B","C","D"].includes(e.correctAnswer))return e.correctAnswer;for(const[t,r]of Object.entries(e.answerChoices))if(r===e.correctAnswer)return t}return e.correctAnswer};t.useEffect(()=>{B(!1),L(!1),u||(te(new Set),q(new Set),V(!1),X({}),ne({}),w({}),f(0))},[x,u,b]),t.useEffect(()=>{if($)return;if(u&&b)return j(b),w(b.userAnswers||{}),f(b.currentQuestionIndex||0),q(new Set(b.flaggedQuestions||[])),V(b.eliminationMode||!1),X(b.eliminatedOptions||{}),te(new Set(b.checkedQuestions||[])),ne(b.showExplanation||{}),void B(!0);if(Ne||!je)return;if(!x||0===x.length)return void m();if(O||k)return;const e=x.map(Ie),t=je.createNewQuiz(e);j(t),B(!0)},[x,u,b,$,O,k,m,Ne,je]),t.useEffect(()=>{if(v&&Object.keys(p).length>0){const e=v.userAnswers||{};Object.keys(p).some(t=>p[t]!==e[t])&&L(!0)}},[p,v]);const _e=v?.questions?.[h],Te=e=>{if(!_e)return;Se(pe);const t=e===_e.correctAnswer;w(t=>({...t,[_e.id]:e})),j(r=>({...r,questions:r.questions.map((r,n)=>n===h?{...r,userAnswer:e,isCorrect:t}:r)}))},Re=()=>{if(!_e)return;const e=p[_e.id];if(!e)return void alert("Please select an answer before checking.");const t=Qe(_e);let r=!1;if(e===_e.correctAnswer)r=!0;else if(["A","B","C","D"].includes(e)&&e===t)r=!0;else if(_e.answerChoices&&_e.answerChoices[e]===_e.correctAnswer)r=!0;else if(_e.answerChoices&&_e.answerChoices[t]===e)r=!0;else if(_e.options){const n=["A","B","C","D"].indexOf(t);-1!==n&&_e.options[n]===e&&(r=!0)}Se(r?we:ke),te(e=>new Set([...e,_e.id])),_e.explanation&&ne(e=>({...e,[_e.id]:!0}))},Oe=()=>{_e&&q(e=>{const t=new Set(e);return t.has(_e.id)?t.delete(_e.id):t.add(_e.id),t})},De=()=>{V(e=>!e)},Me=e=>{if(!_e)return;const t=_e.id,r=Y[t]||[];X(n=>({...n,[t]:r.includes(e)?r.filter(t=>t!==e):[...r,e]}))},Pe=async e=>{if(e&&(e.preventDefault(),e.stopPropagation()),P(!0),v&&je)try{const e={...v,userAnswers:p,currentQuestionIndex:h,flaggedQuestions:Array.from(N),eliminatedOptions:Y,eliminationMode:U,checkedQuestions:Array.from(ee),showExplanation:re,timeSpent:E,lastUpdated:(new Date).toISOString()};await je.saveQuiz(e)}catch(t){return alert("Failed to save quiz progress. Please try again."),void P(!1)}J(!1),P(!1),ve("/history")};t.useEffect(()=>{const e=e=>{const t=K.current&&!K.current.contains(e.target),r=Z.current&&!Z.current.contains(e.target);t&&r&&J(!1)};return G&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[G]);const $e=async()=>{if(v&&v.questions&&!O){D(!0);try{const e=v.questions.map(e=>{const t=p[e.id]??e.userAnswer;let r=t;if(e.answerChoices&&t&&!["A","B","C","D"].includes(t))for(const[s,o]of Object.entries(e.answerChoices))if(o===t){r=s;break}const n=r===(e.answerChoices&&e.correctAnswer&&!["A","B","C","D"].includes(e.correctAnswer)&&Object.entries(e.answerChoices).find(([t,r])=>r===e.correctAnswer)?.[0]||e.correctAnswer);return{...e,userAnswer:r,isCorrect:n}});if(!je)throw new Error("QuizManager not available");const t=await je.finishQuiz(v,e,p,N,E),r={...qe||{}};e.forEach(e=>{e.userAnswer&&(r[e.id]||(r[e.id]=[]),r[e.id]=r[e.id].filter(e=>e.quizId!==t.id),r[e.id].push({quizId:t.id,answer:e.userAnswer,isCorrect:e.isCorrect,date:t.date}))}),await Ce(r),localStorage.removeItem("satlog:resumeQuizId"),j(t),ae.current=t,ve("/history",{state:{showCelebration:!0,celebrationId:`quiz-${t.id}-${Date.now()}`}})}catch(e){alert("There was an error completing the quiz. Please try again."),ve("/history")}finally{D(!1)}}},Be=e=>e<h?"blue":e===h?"yellow":"gray";return t.useEffect(()=>{const e=e=>{const t=ae.current,r=ie.current,n=ce.current,s=xe.current,o=me.current;if(t&&t.questions&&!s&&!o&&(Object.keys(r).length>0||n>0))return le.current,Array.from(de.current),be.current,ge.current,Array.from(he.current),fe.current,(new Date).toISOString(),e.preventDefault(),e.returnValue="You have unsaved quiz progress. Are you sure you want to leave?",e.returnValue};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[]),v&&v.questions&&_e?k?e.jsx("div",{className:"flex items-center justify-center p-4 h-screen",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-2xl w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Almost Done!"}),e.jsx("p",{className:"text-gray-600",children:"Here's how you performed"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"text-center p-6 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"text-4xl font-bold text-blue-600 mb-2",children:[v.score,"%"]}),e.jsx("div",{className:"text-gray-600 font-medium",children:"Overall Score"})]}),e.jsxs("div",{className:"text-center p-6 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-4xl font-bold text-green-600 mb-2",children:v.correctAnswers}),e.jsx("div",{className:"text-gray-600 font-medium",children:"Correct Answers"})]}),e.jsxs("div",{className:"text-center p-6 bg-red-50 rounded-lg",children:[e.jsx("div",{className:"text-4xl font-bold text-red-600 mb-2",children:v.totalQuestions-v.correctAnswers}),e.jsx("div",{className:"text-gray-600 font-medium",children:"Incorrect Answers"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Quiz Summary"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Questions:"}),e.jsx("span",{className:"font-medium ml-2",children:v.totalQuestions})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Time Spent:"}),e.jsx("span",{className:"font-medium ml-2",children:ze(E)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Flagged for Review:"}),e.jsx("span",{className:"font-medium ml-2",children:N.size})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Completion:"}),e.jsxs("span",{className:"font-medium ml-2",children:[Math.round((v.totalQuestions-v.correctAnswers)/v.totalQuestions*100),"%"]})]})]})]}),e.jsxs("div",{className:"flex justify-center space-x-4",children:[e.jsx("button",{onClick:()=>{y(!1),R(!0)},className:"bg-gray-200 text-gray-700 px-6 py-3 rounded-lg font-medium hover:bg-gray-300 transition-colors",children:"Back to Review"}),e.jsx("button",{onClick:$e,disabled:O,className:"px-6 py-3 rounded-lg font-medium transition-colors "+(O?"bg-gray-400 text-gray-600 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:O?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Finishing..."})]}):"Finish Quiz"})]})]})}):T?e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-900 flex flex-col h-screen overflow-hidden transition-colors duration-300",children:[e.jsx("header",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 p-3 sm:p-4 flex-shrink-0 relative transition-colors duration-300",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3 sm:gap-0",children:[e.jsx("div",{className:"flex items-center sm:flex-1",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-base sm:text-lg font-semibold text-gray-900 dark:text-white transition-colors duration-300",children:["Quiz ",v?.quizNumber??"N/A"]}),e.jsxs("button",{className:"text-xs sm:text-sm text-blue-600 dark:text-blue-400 hover:underline flex items-center transition-colors duration-300",children:["Directions ",e.jsx("span",{className:"material-icons text-sm",children:"arrow_drop_down"})]})]})}),e.jsx("div",{className:"absolute top-3 left-1/2 transform -translate-x-1/2 sm:relative sm:top-auto sm:left-auto sm:transform-none sm:flex-1 sm:flex sm:justify-center text-center",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-lg sm:text-2xl font-bold text-gray-900 dark:text-white transition-opacity duration-300 "+(A?"opacity-0":"opacity-100"),children:ze(E)}),e.jsx("button",{onClick:()=>z(!A),className:"text-xs bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-2 py-1 rounded hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors duration-300",children:A?"Show":"Hide"})]})}),e.jsxs("div",{className:"hidden sm:flex items-center space-x-4 sm:flex-1 sm:justify-end",children:[e.jsxs("button",{className:"text-sm text-gray-700 dark:text-gray-300 hover:text-black dark:hover:text-white flex items-center transition-colors duration-300",children:[e.jsx("span",{className:"material-icons mr-1",children:"edit"})," Annotate"]}),e.jsxs("div",{className:"relative",ref:K,children:[e.jsxs("button",{onClick:()=>J(!G),className:"text-sm text-gray-700 dark:text-gray-300 hover:text-black dark:hover:text-white flex items-center transition-colors duration-300",children:[e.jsx("span",{className:"material-icons mr-1",children:"more_vert"})," More"]}),G&&e.jsx("div",{className:"absolute right-0 top-full mt-1 w-48 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-50",children:e.jsxs("button",{onClick:Pe,disabled:M,"data-testid":"main-desktop-save-exit-btn",className:"save-exit-btn w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200 flex items-center disabled:opacity-50",children:[e.jsx("span",{className:"material-icons mr-2 text-sm",children:M?"hourglass_empty":"save"}),M?"Saving...":"Save and Exit"]})})]})]}),e.jsxs("div",{className:"flex sm:hidden items-center space-x-3 absolute top-3 right-3",children:[e.jsx("button",{className:"text-gray-700 dark:text-gray-300 hover:text-black dark:hover:text-white transition-colors duration-300",children:e.jsx("span",{className:"material-icons text-lg",children:"edit"})}),e.jsxs("div",{className:"relative",ref:Z,children:[e.jsx("button",{onClick:()=>J(!G),className:"text-gray-700 dark:text-gray-300 hover:text-black dark:hover:text-white transition-colors duration-300",children:e.jsx("span",{className:"material-icons text-lg",children:"more_vert"})}),G&&e.jsx("div",{className:"absolute right-0 top-full mt-1 w-48 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-50",children:e.jsxs("button",{onClick:Pe,disabled:M,"data-testid":"main-mobile-save-exit-btn",className:"save-exit-btn w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200 flex items-center disabled:opacity-50",children:[e.jsx("span",{className:"material-icons mr-2 text-sm",children:M?"hourglass_empty":"save"}),M?"Saving...":"Save and Exit"]})})]})]})]})}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden bg-white dark:bg-gray-800 transition-colors duration-300",children:[e.jsxs("div",{className:"text-center py-4 sm:py-6 px-3 sm:px-0",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 dark:text-white mb-2 transition-colors duration-300",children:"Check Your Work"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-xs sm:text-sm mb-1 transition-colors duration-300",children:"On test day, you won't be able to move on to the next module until time expires."}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 text-xs sm:text-sm mb-4 sm:mb-6 transition-colors duration-300",children:["For these practice questions, you can click ",e.jsx("strong",{children:"Next"})," when you're ready to move on."]}),e.jsx("div",{className:"w-full border-t border-gray-300 dark:border-gray-600 mb-4 sm:mb-6 transition-colors duration-300"})]}),e.jsx("div",{className:"flex-1 flex justify-center px-3 sm:px-6 lg:px-8 pb-4 sm:pb-6 lg:pb-8",children:e.jsxs("div",{className:"bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg p-3 sm:p-6 lg:p-8 w-full max-w-5xl transition-colors duration-300",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 sm:mb-6 gap-3",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 dark:text-white transition-colors duration-300",children:"Section 1: Reading and Writing Module 1"}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 sm:gap-6",children:[e.jsxs("div",{className:"flex items-center text-xs sm:text-sm text-gray-700 dark:text-gray-300 transition-colors duration-300",children:[e.jsx("span",{className:"w-3 h-3 border-2 border-dashed border-gray-400 dark:border-gray-500 mr-2 transition-colors duration-300"}),e.jsx("span",{children:"Unanswered"})]}),e.jsxs("div",{className:"flex items-center text-xs sm:text-sm text-gray-700 dark:text-gray-300 transition-colors duration-300",children:[e.jsx("span",{className:"material-icons text-base mr-1 text-red-500",children:"bookmark"}),e.jsx("span",{children:"For Review"})]}),U&&e.jsxs("div",{className:"flex items-center text-xs sm:text-sm text-gray-700 dark:text-gray-300 transition-colors duration-300",children:[e.jsx("span",{className:"material-icons text-base mr-1 text-red-500",children:"close"}),e.jsx("span",{children:"Eliminated"})]})]})]}),e.jsx("div",{className:"flex w-full mb-4 sm:mb-6",children:v.questions.map((t,r)=>e.jsx("div",{className:"h-2 flex-1 "+(r<h?"bg-blue-500":r===h?"bg-yellow-400":"bg-gray-300")},r))}),e.jsx("div",{className:"grid grid-cols-5 sm:grid-cols-8 lg:grid-cols-10 gap-2 sm:gap-3 mb-4 sm:mb-6 justify-items-center",children:v.questions.map((t,r)=>{const n=p[t.id],s=r===h,o=N.has(t.id),a=(Y[t.id]||[]).length>0;return e.jsxs("div",{onClick:()=>{f(r),R(!1)},className:`relative p-1.5 sm:p-2 text-center rounded cursor-pointer border-2 transition-all w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center ${n?"bg-blue-500 border-blue-500 text-white":"border-dashed border-gray-400 dark:border-gray-500 text-blue-600 dark:text-blue-400 hover:bg-gray-50 dark:hover:bg-gray-600"} ${s?"ring-2 ring-black dark:ring-white":""}`,children:[e.jsx("span",{className:"font-medium text-xs sm:text-sm",children:r+1}),s&&e.jsx("span",{className:"material-icons absolute -top-5 sm:-top-6 left-1/2 transform -translate-x-1/2 text-black dark:text-white text-base sm:text-lg transition-colors duration-300",children:"location_on"}),o&&e.jsx("span",{className:"material-icons absolute top-0.5 sm:top-1 right-0.5 sm:right-1 text-red-500 text-xs",children:"flag"}),a&&e.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-gray-400 dark:bg-gray-600 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs",children:"✕"})})]},r)})})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 p-4 sm:p-6 flex flex-col sm:flex-row sm:justify-between sm:items-center flex-shrink-0 transition-colors duration-300 gap-4 sm:gap-0",children:[e.jsx("div",{className:"text-sm text-gray-700 dark:text-gray-300 transition-colors duration-300 text-center sm:text-left",children:"Ready to submit your quiz?"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-3 sm:gap-4",children:[e.jsx("button",{onClick:()=>R(!1),className:"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-6 py-3 rounded-lg text-sm font-medium hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors duration-300 w-full sm:w-auto",children:"Back to Questions"}),e.jsx("button",{onClick:$e,disabled:O,className:"px-8 py-3 rounded-lg text-sm font-medium transition-colors duration-300 shadow-lg hover:shadow-xl w-full sm:w-auto "+(O?"bg-gray-400 text-gray-600 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"),children:O?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Finishing..."})]}):"Finish Quiz"})]})]}),e.jsx("div",{className:"flex w-full flex-shrink-0",children:v.questions.map((t,r)=>e.jsx("div",{className:`progress-bar-segment ${Be(r)}`},r))}),W.show&&e.jsx(l,{pointsAwarded:W.points,actionType:W.action,onComplete:Ae})]}):e.jsxs("div",{className:"quiz-page-container bg-gradient-to-br from-slate-50 to-blue-50 dark:from-slate-900 dark:to-slate-800 transition-all duration-500 flex flex-col h-screen overflow-hidden",children:[e.jsx("style",{children:"\n        /* Disable outer page scrolling */\n        html, body {\n          overflow: hidden !important;\n          position: fixed !important;\n          width: 100% !important;\n          height: 100% !important;\n        } /* Disable overscroll (pull-to-refresh) */\n        html, body, .quiz-page-container {\n          overscroll-behavior: none !important;\n          overscroll-behavior-x: none !important;\n          overscroll-behavior-y: none !important;\n          -webkit-overflow-scrolling: auto !important;\n          -webkit-overscroll-behavior: none !important;\n          -webkit-overscroll-behavior-x: none !important;\n          -webkit-overscroll-behavior-y: none !important;\n        }\n        \n        /* Prevent touch scrolling beyond boundaries */\n        .quiz-page-container {\n          touch-action: pan-x pan-y !important;\n          /* allow text selection */\n        }\n        \n        /* Save and Exit button styling */\n        .save-exit-btn {\n          cursor: pointer !important;\n        }\n        .save-exit-btn:disabled {\n          cursor: not-allowed !important;\n        }\n        .save-exit-btn:focus {\n          outline: 2px solid #3b82f6 !important;\n          outline-offset: 2px !important;\n        }\n        \n        /* Mobile-only height adjustment */\n        @media (max-width: 767px) {\n          .quiz-page-container {\n            max-height: 100vh !important;\n            height: 100vh !important;\n          }\n        }\n        \n        /* Safari-specific height fixes */\n        @supports (-webkit-touch-callout: none) {\n          .quiz-page-container {\n            max-height: 90vh !important;\n            height: 90vh !important;\n          }\n          \n          /* Additional Safari mobile fixes */\n          @media (max-width: 767px) {\n            .quiz-page-container {\n              max-height: 90vh !important;\n              height: 90vh !important;\n            }\n          }\n        }\n        \n        .progress-bar-segment {\n          height: 4px;\n          flex-grow: 1;\n          border-radius: 2px;\n          transition: all 0.3s ease;\n        }\n        .progress-bar-segment.blue {\n          background: linear-gradient(90deg, #3b82f6, #60a5fa);\n          box-shadow: 0 1px 3px rgba(59, 130, 246, 0.3);\n        }\n        .progress-bar-segment.yellow {\n          background: linear-gradient(90deg, #fbbf24, #f59e0b);\n          box-shadow: 0 1px 3px rgba(251, 191, 36, 0.3);\n        }\n        .progress-bar-segment.gray {\n          background: linear-gradient(90deg, #e5e7eb, #d1d5db);\n          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n        }\n        .question-option {\n          display: flex;\n          align-items: center;\n          padding: 1rem 1.25rem;\n          border: 2px solid #e2e8f0;\n          border-radius: 1rem;\n          margin-bottom: 1rem;\n          cursor: pointer;\n          transition: background-color 150ms ease-out, border-color 150ms ease-out, box-shadow 150ms ease-out;\n          color: #475569;\n          background: #ffffff;\n          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);\n        }\n        @media (min-width: 640px) {\n          .question-option {\n            background: rgba(255, 255, 255, 0.7);\n            backdrop-filter: blur(10px);\n          }\n        }\n        .dark .question-option {\n          border-color: #475569;\n          color: #cbd5e1;\n          background: #1e293b;\n          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);\n        }\n        @media (min-width: 640px) {\n          .dark .question-option {\n            background: rgba(30, 41, 59, 0.7);\n          }\n        }\n        .question-option:hover {\n          background: #f8fafc;\n          border-color: #94a3b8;\n          transform: translateY(-1px);\n          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\n        }\n        @media (min-width: 640px) {\n          .question-option:hover {\n            background: rgba(255, 255, 255, 0.9);\n          }\n        }\n        .dark .question-option:hover {\n          background: #334155;\n          border-color: #64748b;\n          transform: translateY(-1px);\n          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n        }\n        @media (min-width: 640px) {\n          .dark .question-option:hover {\n            background: rgba(30, 41, 59, 0.9);\n          }\n        }\n        .question-option.selected {\n          background-color: #dbeafe;\n          border-color: #3b82f6;\n          box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);\n        }\n        .dark .question-option.selected {\n          background-color: #1e3a8a;\n          border-color: #3b82f6;\n          box-shadow: 0 4px 12px rgba(59, 130, 246, 0.25);\n        }\n        .question-option.selected:hover {\n          background-color: #bfdbfe;\n          border-color: #2563eb;\n          box-shadow: 0 6px 16px rgba(59, 130, 246, 0.2);\n        }\n        .dark .question-option.selected:hover {\n          background-color: #1e40af;\n          border-color: #2563eb;\n          box-shadow: 0 6px 16px rgba(59, 130, 246, 0.35);\n        }\n        \n        /* Correct answer styles */\n        .question-option.correct-answer {\n          background-color: #dcfce7;\n          border-color: #22c55e;\n          color: #166534;\n          cursor: not-allowed;\n        }\n        .dark .question-option.correct-answer {\n          background-color: #14532d;\n          border-color: #22c55e;\n          color: #bbf7d0;\n          cursor: not-allowed;\n        }\n        .question-option.correct-answer .option-letter {\n          background-color: #22c55e;\n          color: white;\n          border-color: #22c55e;\n        }\n        /* Higher specificity to override selected state */\n        .question-option.selected.correct-answer .option-letter {\n          background-color: #22c55e !important;\n          color: white !important;\n          border-color: #22c55e !important;\n        }\n        .question-option.correct-answer:hover {\n          background-color: #dcfce7;\n          border-color: #22c55e;\n          cursor: not-allowed;\n        }\n        .dark .question-option.correct-answer:hover {\n          background-color: #14532d;\n          border-color: #22c55e;\n          cursor: not-allowed;\n        }\n        \n        /* Incorrect answer styles */\n        .question-option.incorrect-answer {\n          background-color: #fef2f2;\n          border-color: #ef4444;\n          color: #991b1b;\n          cursor: not-allowed;\n        }\n        .dark .question-option.incorrect-answer {\n          background-color: #7f1d1d;\n          border-color: #ef4444;\n          color: #fecaca;\n          cursor: not-allowed;\n        }\n        .question-option.incorrect-answer .option-letter {\n          background-color: #ef4444;\n          color: white;\n          border-color: #ef4444;\n        }\n        /* Higher specificity to override selected state */\n        .question-option.selected.incorrect-answer .option-letter {\n          background-color: #ef4444 !important;\n          color: white !important;\n          border-color: #ef4444 !important;\n        }\n        .question-option.incorrect-answer:hover {\n          background-color: #fef2f2;\n          border-color: #ef4444;\n          cursor: not-allowed;\n        }\n        .dark .question-option.incorrect-answer:hover {\n          background-color: #7f1d1d;\n          border-color: #ef4444;\n          cursor: not-allowed;\n        }\n        \n        /* Unselected wrong answers when checked */\n        .question-option.unselected-wrong {\n          background-color: #f9fafb;\n          border-color: #e5e7eb;\n          color: #6b7280;\n          opacity: 0.7;\n          cursor: not-allowed;\n        }\n        .dark .question-option.unselected-wrong {\n          background-color: #374151;\n          border-color: #4b5563;\n          color: #9ca3af;\n          opacity: 0.7;\n          cursor: not-allowed;\n        }\n        .question-option.unselected-wrong .option-letter {\n          background-color: #9ca3af;\n          color: #6b7280;\n          border-color: #9ca3af;\n        }\n        .dark .question-option.unselected-wrong .option-letter {\n          background-color: #6b7280;\n          color: #9ca3af;\n          border-color: #6b7280;\n        }\n        .question-option.unselected-wrong:hover {\n          background-color: #f9fafb;\n          border-color: #e5e7eb;\n          opacity: 0.7;\n          cursor: not-allowed;\n        }\n        .dark .question-option.unselected-wrong:hover {\n          background-color: #374151;\n          border-color: #4b5563;\n          opacity: 0.7;\n          cursor: not-allowed;\n        }\n        \n        /* Eliminated option styles */\n        .question-option.eliminated {\n          opacity: 0.3;\n          pointer-events: none;\n          background-color: #f9fafb;\n          border-color: #e5e7eb;\n          position: relative;\n          overflow: visible !important;\n        }\n        .dark .question-option.eliminated {\n          opacity: 0.3;\n          pointer-events: none;\n          background-color: #374151;\n          border-color: #4b5563;\n          position: relative;\n          overflow: visible !important;\n        }\n        .question-option.eliminated::after {\n          content: '';\n          position: absolute;\n          top: 50%;\n          left: -20px !important;\n          right: -10px !important;\n          height: 2px;\n          background-color: #374151 !important;\n          transform: translateY(-50%);\n          z-index: 15 !important;\n          margin: 0 !important;\n          opacity: 1 !important;\n        }\n        .dark .question-option.eliminated::after {\n          background-color: #9ca3af !important;\n        }\n        .question-option.eliminated .option-letter {\n          background-color: #9ca3af;\n          color: #6b7280;\n          border-color: #9ca3af;\n        }\n        .dark .question-option.eliminated .option-letter {\n          background-color: #6b7280;\n          color: #9ca3af;\n          border-color: #6b7280;\n        }\n        .question-option.eliminated:hover {\n          background-color: #f9fafb;\n          border-color: #e5e7eb;\n          opacity: 0.3;\n        }\n        .dark .question-option.eliminated:hover {\n          background-color: #374151;\n          border-color: #4b5563;\n          opacity: 0.3;\n        }\n        \n        /* ABC button styles */\n        .btn-default.btn-line-black.undo-btn {\n          position: relative;\n          overflow: hidden;\n        }\n        .option-letter {\n          display: inline-flex;\n          align-items: center;\n          justify-content: center;\n          width: 2rem;\n          height: 2rem;\n          border-radius: 50%;\n          border: 2px solid #cbd5e1;\n          margin-right: 1rem;\n          font-weight: 600;\n          font-size: 0.875rem;\n          transition: background-color 150ms ease-out, border-color 150ms ease-out, color 150ms ease-out;\n          color: #64748b;\n          background: #ffffff;\n        }\n        @media (min-width: 640px) {\n          .option-letter {\n            background: rgba(255, 255, 255, 0.8);\n          }\n        }\n        .dark .option-letter {\n          border-color: #475569;\n          color: #94a3b8;\n          background: #1e293b;\n        }\n        @media (min-width: 640px) {\n          .dark .option-letter {\n            background: rgba(30, 41, 59, 0.8);\n          }\n        }\n        .question-option.selected .option-letter {\n          background: linear-gradient(135deg, #3b82f6, #2563eb);\n          color: white;\n          border-color: #3b82f6;\n          box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);\n        }\n        /* Quiz content font - Poppins for passage, question, choices, and explanation */\n        .quiz-content-text {\n          font-family: 'Poppins', sans-serif !important;\n        }\n        \n        /* Question box base styles - no hover effects */\n        .question-box {\n          border: 2px solid #e5e7eb;\n          cursor: pointer;\n          padding: 8px;\n          margin: 4px;\n          border-radius: 8px;\n          min-height: 36px;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          background-color: #f9fafb;\n          color: #374151;\n          font-weight: 500;\n          font-size: 14px;\n          position: relative;\n        }\n        .dark .question-box {\n          border-color: #4b5563;\n          background-color: #374151;\n          color: #d1d5db;\n        }\n        \n        /* DISABLE ALL HOVER/FOCUS/ACTIVE EFFECTS */\n        .question-box:hover,\n        .question-box:focus,\n        .question-box:active,\n        .question-box:focus-visible,\n        .question-box:focus-within {\n          border-color: #e5e7eb !important;\n          background-color: #f9fafb !important;\n          color: #374151 !important;\n          transform: none !important;\n          box-shadow: none !important;\n          outline: none !important;\n        }\n        .dark .question-box:hover,\n        .dark .question-box:focus,\n        .dark .question-box:active,\n        .dark .question-box:focus-visible,\n        .dark .question-box:focus-within {\n          border-color: #4b5563 !important;\n          background-color: #374151 !important;\n          color: #d1d5db !important;\n        }\n        \n        /* Current question indicator - only the arrow, same background */\n        .question-box.current {\n          /* Keep same colors as unanswered */\n          border-color: #e5e7eb;\n          background-color: #f9fafb;\n          color: #374151;\n        }\n        .dark .question-box.current {\n          border-color: #4b5563;\n          background-color: #374151;\n          color: #d1d5db;\n        }\n        .question-box.current::before {\n          content: \"\\e0c8\";\n          font-family: 'Material Icons';\n          position: absolute;\n          top: -24px;\n          left: 50%;\n          transform: translateX(-50%);\n          font-size: 24px;\n          color: #374151; /* Dark icon for light mode */\n        }\n        .dark .question-box.current::before {\n          color: #d1d5db; /* Light icon for dark mode */\n        }\n        .question-box.current:hover,\n        .question-box.current:focus,\n        .question-box.current:active,\n        .question-box.current:focus-visible {\n          border-color: #e5e7eb !important;\n          background-color: #f9fafb !important;\n          color: #374151 !important;\n        }\n        .dark .question-box.current:hover,\n        .dark .question-box.current:focus,\n        .dark .question-box.current:active,\n        .dark .question-box.current:focus-visible {\n          border-color: #4b5563 !important;\n          background-color: #374151 !important;\n          color: #d1d5db !important;\n        }\n        \n        /* Answered questions - blue background */\n        .question-box.answered {\n          background-color: #3b82f6;\n          border-color: #3b82f6;\n          color: white;\n        }\n        .dark .question-box.answered {\n          background-color: #2563eb;\n          border-color: #2563eb;\n          color: white;\n        }\n        .question-box.answered span {\n          color: white;\n        }\n        .question-box.answered:hover,\n        .question-box.answered:focus,\n        .question-box.answered:active,\n        .question-box.answered:focus-visible {\n          background-color: #3b82f6 !important;\n          border-color: #3b82f6 !important;\n          color: white !important;\n        }\n        .dark .question-box.answered:hover,\n        .dark .question-box.answered:focus,\n        .dark .question-box.answered:active,\n        .dark .question-box.answered:focus-visible {\n          background-color: #2563eb !important;\n          border-color: #2563eb !important;\n          color: white !important;\n        }\n        \n        /* Flagged questions - only add the flag, no background changes */\n        .question-box.flagged::after {\n          content: \"🚩\";\n          position: absolute;\n          top: 2px;\n          right: 2px;\n          font-size: 12px;\n          color: #ef4444;\n        }\n        \n        /* Make sure flagged unanswered questions keep their base colors */\n        .question-box.flagged:not(.answered):not(.current) {\n          border-color: #e5e7eb;\n          background-color: #f9fafb;\n          color: #374151;\n        }\n        .dark .question-box.flagged:not(.answered):not(.current) {\n          border-color: #4b5563;\n          background-color: #374151;\n          color: #d1d5db;\n        }\n        \n        /* Flagged + Answered combination - Higher specificity */\n        .question-box.answered.flagged {\n          background-color: #3b82f6 !important;\n          border-color: #3b82f6 !important;\n          color: white !important;\n        }\n        .dark .question-box.answered.flagged {\n          background-color: #2563eb !important;\n          border-color: #2563eb !important;\n          color: white !important;\n        }\n        .question-box.answered.flagged:hover,\n        .question-box.answered.flagged:focus,\n        .question-box.answered.flagged:active,\n        .question-box.answered.flagged:focus-visible {\n          background-color: #3b82f6 !important;\n          border-color: #3b82f6 !important;\n          color: white !important;\n        }\n        .dark .question-box.answered.flagged:hover,\n        .dark .question-box.answered.flagged:focus,\n        .dark .question-box.answered.flagged:active,\n        .dark .question-box.answered.flagged:focus-visible {\n          background-color: #2563eb !important;\n          border-color: #2563eb !important;\n          color: white !important;\n        }\n        \n        /* Flagged + Current combination - same as current, just adds flag */\n        .question-box.current.flagged {\n          border-color: #e5e7eb;\n          background-color: #f9fafb;\n          color: #374151;\n        }\n        .dark .question-box.current.flagged {\n          border-color: #4b5563;\n          background-color: #374151;\n          color: #d1d5db;\n        }\n        \n        /* Questions with eliminated options */\n        .question-box.has-eliminated {\n          border-color: #9ca3af;\n          background-color: #f3f4f6;\n        }\n        .dark .question-box.has-eliminated {\n          border-color: #6b7280;\n          background-color: #4b5563;\n        }\n        .question-box.has-eliminated:hover,\n        .question-box.has-eliminated:focus,\n        .question-box.has-eliminated:active,\n        .question-box.has-eliminated:focus-visible {\n          border-color: #9ca3af !important;\n          background-color: #f3f4f6 !important;\n        }\n        .dark .question-box.has-eliminated:hover,\n        .dark .question-box.has-eliminated:focus,\n        .dark .question-box.has-eliminated:active,\n        .dark .question-box.has-eliminated:focus-visible {\n          border-color: #6b7280 !important;\n          background-color: #4b5563 !important;\n        }\n      "}),e.jsx("header",{className:"bg-white dark:bg-slate-800 sm:bg-white/80 sm:dark:bg-slate-800/80 sm:backdrop-blur-xl border-b border-slate-200 dark:border-slate-700 sm:border-slate-200/50 sm:dark:border-slate-700/50 p-4 sm:p-6 flex-shrink-0 relative transition-all duration-500 shadow-sm",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3 sm:gap-0",children:[e.jsx("div",{className:"flex items-center sm:flex-1",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-base sm:text-lg font-semibold text-gray-900 dark:text-white transition-colors duration-300",children:["Quiz ",v?.quizNumber??"N/A"]}),e.jsxs("button",{className:"text-xs sm:text-sm text-blue-600 dark:text-blue-400 hover:underline flex items-center transition-colors duration-300",children:["Directions ",e.jsx("span",{className:"material-icons text-sm",children:"arrow_drop_down"})]})]})}),e.jsx("div",{className:"absolute top-3 left-1/2 transform -translate-x-1/2 sm:relative sm:top-auto sm:left-auto sm:transform-none sm:flex-1 sm:flex sm:justify-center text-center",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-xl sm:text-3xl font-bold text-slate-800 dark:text-slate-200 sm:bg-gradient-to-r sm:from-slate-800 sm:to-slate-900 sm:dark:from-slate-200 sm:dark:to-slate-100 sm:bg-clip-text sm:text-transparent transition-all duration-500 "+(A?"opacity-0":"opacity-100"),children:ze(E)}),e.jsx("button",{onClick:()=>z(!A),className:"text-xs bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 px-3 py-1.5 rounded-lg hover:bg-slate-200 dark:hover:bg-slate-600 transition-all duration-300 shadow-sm",children:A?"Show":"Hide"})]})}),e.jsxs("div",{className:"hidden sm:flex items-center space-x-4 sm:flex-1 sm:justify-end",children:[e.jsxs("button",{className:"text-sm text-gray-700 dark:text-gray-300 hover:text-black dark:hover:text-white flex items-center transition-colors duration-300",children:[e.jsx("span",{className:"material-icons mr-1",children:"edit"})," Annotate"]}),e.jsxs("div",{className:"relative",ref:K,children:[e.jsxs("button",{onClick:()=>J(!G),className:"text-sm text-gray-700 dark:text-gray-300 hover:text-black dark:hover:text-white flex items-center transition-colors duration-300",children:[e.jsx("span",{className:"material-icons mr-1",children:"more_vert"})," More"]}),G&&e.jsx("div",{className:"absolute right-0 top-full mt-1 w-48 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-50",children:e.jsxs("button",{onClick:Pe,disabled:M,"data-testid":"review-desktop-save-exit-btn",className:"save-exit-btn w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200 flex items-center disabled:opacity-50",children:[e.jsx("span",{className:"material-icons mr-2 text-sm",children:M?"hourglass_empty":"save"}),M?"Saving...":"Save and Exit"]})})]})]}),e.jsxs("div",{className:"flex sm:hidden items-center space-x-3 absolute top-3 right-3",children:[e.jsx("button",{className:"text-gray-700 dark:text-gray-300 hover:text-black dark:hover:text-white transition-colors duration-300",children:e.jsx("span",{className:"material-icons text-lg",children:"edit"})}),e.jsxs("div",{className:"relative",ref:Z,children:[e.jsx("button",{onClick:()=>J(!G),className:"text-gray-700 dark:text-gray-300 hover:text-black dark:hover:text-white transition-colors duration-300",children:e.jsx("span",{className:"material-icons text-lg",children:"more_vert"})}),G&&e.jsx("div",{className:"absolute right-0 top-full mt-1 w-48 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-50",children:e.jsxs("button",{onClick:Pe,disabled:M,"data-testid":"review-mobile-save-exit-btn",className:"save-exit-btn w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200 flex items-center disabled:opacity-50",children:[e.jsx("span",{className:"material-icons mr-2 text-sm",children:M?"hourglass_empty":"save"}),M?"Saving...":"Save and Exit"]})})]})]})]})}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden min-h-0",children:[e.jsxs("div",{className:"block md:hidden flex flex-col h-full",children:[e.jsx("div",{className:"p-3 sm:p-4 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 transition-colors duration-300 flex-shrink-0",children:e.jsx("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"bg-gradient-to-r from-slate-800 to-slate-900 dark:from-slate-700 dark:to-slate-800 text-white text-xs sm:text-sm font-semibold px-3 py-1.5 rounded-lg mr-3 transition-all duration-300 shadow-sm",children:h+1}),e.jsxs("button",{onClick:Oe,className:"text-xs sm:text-sm text-gray-700 dark:text-gray-300 hover:text-black dark:hover:text-white flex items-center transition-colors duration-300",children:[e.jsx("span",{className:"material-icons text-base sm:text-lg mr-1 "+(N.has(_e.id)?"text-red-500":""),children:N.has(_e.id)?"bookmark":"bookmark_border"}),e.jsx("span",{className:N.has(_e.id)?"text-red-500":"",children:"Mark for Review"})]}),e.jsxs("button",{onClick:Re,disabled:ee.has(_e.id)||!p[_e.id],className:"text-xs sm:text-sm text-gray-700 dark:text-gray-300 hover:text-black dark:hover:text-white flex items-center transition-colors duration-300 ml-4 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("span",{className:"material-icons text-base sm:text-lg mr-1",children:ee.has(_e.id)?"check_circle":"check_circle_outline"}),e.jsx("span",{children:ee.has(_e.id)?"Checked":"Check Answer"})]}),e.jsxs("button",{onClick:De,className:"btn-default btn-line-black undo-btn text-xs sm:text-sm font-medium px-3 py-1 rounded-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 flex items-center justify-center relative ml-4",style:{minWidth:"38px",minHeight:"26px",height:"26px",padding:"0 10px"},children:[e.jsx("span",{style:{position:"relative",zIndex:1},children:"ABC"}),e.jsx("svg",{width:"100%",height:"100%",viewBox:"0 0 38 26",style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:2},children:e.jsx("line",{x1:"2",y1:"24",x2:"36",y2:"2",stroke:"#333",strokeWidth:"2",strokeLinecap:"round"})})]})]})})}),e.jsxs("div",{className:"flex-1 p-4 sm:p-6 bg-white dark:bg-slate-800 sm:bg-white/70 sm:dark:bg-slate-800/70 sm:backdrop-blur-lg border-b border-slate-200 dark:border-slate-700 sm:border-slate-200/30 sm:dark:border-slate-700/30 transition-all duration-500 flex flex-col",children:[e.jsx("div",{className:"flex justify-between items-center mb-3 sm:mb-4 flex-shrink-0",children:e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 transition-colors duration-300",children:"Passage"})}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[_e.passageImage&&e.jsx("img",{src:_e.passageImage,alt:"Passage",className:"max-h-60 sm:max-h-80 rounded shadow border mb-2 mx-auto w-full object-contain"}),_e.passageText&&e.jsx("p",{className:"quiz-content-text text-base sm:text-base font-medium sm:font-normal text-gray-700 dark:text-gray-300 transition-colors duration-300 leading-relaxed",children:d(_e.passageText,_e.questionType)}),!_e.passageText&&!_e.passageImage&&e.jsx("p",{className:"quiz-content-text text-base sm:text-base font-medium sm:font-normal text-gray-700 dark:text-gray-300 transition-colors duration-300 leading-relaxed",children:_e.questionText})]})]}),e.jsxs("div",{className:"p-4 sm:p-6 bg-white dark:bg-slate-800 sm:bg-white/70 sm:dark:bg-slate-800/70 sm:backdrop-blur-lg transition-all duration-500 flex flex-col",children:[e.jsx("div",{className:"flex-shrink-0 mb-3 sm:mb-4",children:e.jsx("p",{className:"quiz-content-text text-sm sm:text-base text-gray-700 dark:text-gray-300 transition-colors duration-300",children:_e.passageText?_e.questionText:"Which choice completes the text with the most logical and precise word or phrase?"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"space-y-2 sm:space-y-3 mt-2",style:{overflow:"visible"},children:(_e.options||Object.values(_e.answerChoices||{})).map((t,r)=>{const n=Ee(t),s=String.fromCharCode(65+r),o=p[_e.id]===t,a=U&&Y[_e.id]?.includes(t),i=ee.has(_e.id),l=s===Qe(_e);let d="";return i?d=o&&l?"selected correct-answer":o&&!l?"selected incorrect-answer":!o&&l?"correct-answer":"unselected-wrong":(d=o?"selected":"",a&&(d+=" eliminated")),e.jsxs("div",{className:"flex items-center space-x-3",style:{overflow:"visible"},children:[e.jsxs("div",{onClick:()=>Te(t),className:`question-option min-w-0 ${d}`,style:{padding:"0.5rem 0.75rem",width:U?"calc(100% - 80px)":"100%",display:"flex",alignItems:"center"},children:[e.jsx("span",{className:"option-letter",style:{width:"1.5rem",height:"1.5rem",marginRight:"0.5rem",flexShrink:0},children:s}),e.jsx("span",{className:"quiz-content-text text-sm sm:text-base",style:{flex:1,minWidth:0},children:n})]}),U&&e.jsx("button",{onClick:()=>Me(t),className:"elimination-btn rounded-full border-2 flex items-center justify-center text-xs font-bold transition-all duration-200 flex-shrink-0 "+(a?"bg-gray-400 border-gray-400 text-white px-2 py-1":"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600 w-6 h-6"),children:a?"undo":s})]},r)})}),ee.has(_e.id)&&(_e.explanation||_e.explanationImage)&&e.jsx("div",{className:"mt-6 p-6 bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900 dark:to-indigo-900 sm:from-blue-50/80 sm:to-blue-100/80 sm:dark:from-blue-900/30 sm:dark:to-indigo-900/30 border border-blue-200 dark:border-blue-700 sm:border-blue-200/50 sm:dark:border-blue-700/50 rounded-2xl shadow-sm",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"material-icons text-blue-600 dark:text-blue-400 mr-3 mt-0.5 text-xl",children:"lightbulb"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"quiz-content-text text-sm font-semibold text-blue-800 dark:text-blue-300 mb-2",children:"Explanation"}),_e.explanationImage&&e.jsx("img",{src:_e.explanationImage,alt:"Explanation",className:"max-h-48 w-auto rounded-xl shadow-sm border border-blue-200 dark:border-blue-600 sm:border-blue-200/50 sm:dark:border-blue-600/50 mb-3"}),_e.explanation&&e.jsx("p",{className:"quiz-content-text text-sm text-blue-700 dark:text-blue-400 leading-relaxed",children:_e.explanation})]})]})})]})]})]}),e.jsxs("div",{className:"hidden md:flex flex-row overflow-hidden min-h-0 h-full",children:[e.jsxs("div",{className:"w-1/2 p-6 overflow-y-auto bg-white dark:bg-slate-800 sm:bg-white/70 sm:dark:bg-slate-800/70 sm:backdrop-blur-lg border-r border-slate-200 dark:border-slate-700 sm:border-slate-200/30 sm:dark:border-slate-700/30 transition-all duration-500 flex flex-col h-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 flex-shrink-0",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 transition-colors duration-300",children:"Passage"}),e.jsx("button",{className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors duration-300",children:e.jsx("span",{className:"material-icons",children:"fullscreen"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[_e.passageImage&&e.jsx("img",{src:_e.passageImage,alt:"Passage",className:"max-h-80 rounded shadow border mb-2 mx-auto w-full object-contain cursor-pointer hover:opacity-90 transition-opacity duration-200",onClick:()=>{return e=_e.passageImage,void oe({isOpen:!0,imageSrc:e,imageAlt:"Passage"});var e}}),_e.passageText&&e.jsx("p",{className:"quiz-content-text text-base text-gray-700 dark:text-gray-300 transition-colors duration-300 leading-relaxed",children:d(_e.passageText,_e.questionType)}),!_e.passageText&&!_e.passageImage&&e.jsx("p",{className:"quiz-content-text text-base text-gray-700 dark:text-gray-300 transition-colors duration-300 leading-relaxed",children:_e.questionText})]})]}),e.jsxs("div",{className:"w-1/2 p-6 overflow-y-auto bg-white dark:bg-slate-800 sm:bg-white/70 sm:dark:bg-slate-800/70 sm:backdrop-blur-lg transition-all duration-500 flex flex-col h-full",children:[e.jsx("div",{className:"flex justify-between items-center mb-4 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"bg-gradient-to-r from-slate-800 to-slate-900 dark:from-slate-700 dark:to-slate-800 text-white text-sm font-semibold px-3 py-1.5 rounded-lg mr-3 transition-all duration-300 shadow-sm",children:h+1}),e.jsxs("button",{onClick:Oe,className:"text-sm text-gray-700 dark:text-gray-300 hover:text-black dark:hover:text-white flex items-center transition-colors duration-300",children:[e.jsx("span",{className:"material-icons text-lg mr-1 "+(N.has(_e.id)?"text-red-500":""),children:N.has(_e.id)?"bookmark":"bookmark_border"}),e.jsx("span",{className:N.has(_e.id)?"text-red-500":"",children:"Mark for Review"})]}),e.jsxs("button",{onClick:Re,disabled:ee.has(_e.id)||!p[_e.id],className:"text-sm text-gray-700 dark:text-gray-300 hover:text-black dark:hover:text-white flex items-center transition-colors duration-300 ml-4 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("span",{className:"material-icons text-lg mr-1",children:ee.has(_e.id)?"check_circle":"check_circle_outline"}),e.jsx("span",{children:ee.has(_e.id)?"Checked":"Check Answer"})]}),e.jsxs("button",{onClick:De,className:"btn-default btn-line-black undo-btn text-sm font-medium px-3 py-1 rounded-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 flex items-center justify-center relative ml-4",style:{minWidth:"38px",minHeight:"26px",height:"26px",padding:"0 10px"},children:[e.jsx("span",{style:{position:"relative",zIndex:1},children:"ABC"}),e.jsx("svg",{width:"100%",height:"100%",viewBox:"0 0 38 26",style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:2},children:e.jsx("line",{x1:"2",y1:"24",x2:"36",y2:"2",stroke:"#333",strokeWidth:"2",strokeLinecap:"round"})})]})]})}),e.jsx("div",{className:"flex-shrink-0 mb-4",children:e.jsx("p",{className:"quiz-content-text text-base text-gray-700 dark:text-gray-300 transition-colors duration-300",children:_e.passageText?_e.questionText:"Which choice completes the text with the most logical and precise word or phrase?"})}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[e.jsx("div",{className:"space-y-3 mt-2",style:{overflow:"visible"},children:(_e.options||Object.values(_e.answerChoices||{})).map((t,r)=>{const n=Ee(t),s=String.fromCharCode(65+r),o=p[_e.id]===t,a=U&&Y[_e.id]?.includes(t),i=ee.has(_e.id),l=s===Qe(_e);let d="";return i?d=o&&l?"selected correct-answer":o&&!l?"selected incorrect-answer":!o&&l?"correct-answer":"unselected-wrong":(d=o?"selected":"",a&&(d+=" eliminated")),e.jsxs("div",{className:"flex items-center space-x-3",style:{overflow:"visible"},children:[e.jsxs("div",{onClick:()=>Te(t),className:`question-option min-w-0 ${d}`,style:{padding:"0.75rem 1rem",width:U?"calc(100% - 80px)":"100%",display:"flex",alignItems:"center"},children:[e.jsx("span",{className:"option-letter",style:{width:"1.75rem",height:"1.75rem",marginRight:"0.75rem",flexShrink:0},children:s}),e.jsx("span",{className:"quiz-content-text text-base",style:{flex:1,minWidth:0},children:n})]}),U&&e.jsx("button",{onClick:()=>Me(t),className:"elimination-btn rounded-full border-2 flex items-center justify-center text-xs font-bold transition-all duration-200 flex-shrink-0 "+(a?"bg-gray-400 border-gray-400 text-white px-2 py-1":"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600 w-6 h-6"),children:a?"undo":s})]},r)})}),ee.has(_e.id)&&(_e.explanation||_e.explanationImage)&&e.jsx("div",{className:"mt-6 p-6 bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900 dark:to-indigo-900 sm:from-blue-50/80 sm:to-blue-100/80 sm:dark:from-blue-900/30 sm:dark:to-indigo-900/30 border border-blue-200 dark:border-blue-700 sm:border-blue-200/50 sm:dark:border-blue-700/50 rounded-2xl shadow-sm",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"material-icons text-blue-600 dark:text-blue-400 mr-3 mt-0.5 text-xl",children:"lightbulb"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"quiz-content-text text-sm font-semibold text-blue-800 dark:text-blue-300 mb-2",children:"Explanation"}),_e.explanationImage&&e.jsx("img",{src:_e.explanationImage,alt:"Explanation",className:"max-h-48 w-auto rounded-xl shadow-sm border border-blue-200 dark:border-blue-600 sm:border-blue-200/50 sm:dark:border-blue-600/50 mb-3"}),_e.explanation&&e.jsx("p",{className:"quiz-content-text text-sm text-blue-700 dark:text-blue-400 leading-relaxed",children:_e.explanation})]})]})})]})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 sm:bg-white/80 sm:dark:bg-slate-800/80 sm:backdrop-blur-xl border-t border-slate-200 dark:border-slate-700 sm:border-slate-200/50 sm:dark:border-slate-700/50 p-4 sm:p-6 flex flex-col sm:flex-row sm:justify-between sm:items-center flex-shrink-0 transition-all duration-500 relative gap-3 sm:gap-0 shadow-sm",children:[e.jsxs("div",{className:"hidden sm:block text-xs sm:text-sm text-gray-700 dark:text-gray-300 transition-colors duration-300 text-center sm:text-left sm:flex-1",children:["Welcome, ",(()=>{if(!ye)return"User";const e=ye.user_metadata||{};if(e.name&&e.name.trim()&&!/^new\s+user$/i.test(e.name))return e.name.trim();const t=[e.first_name||e.given_name||"",e.last_name||e.family_name||""].filter(Boolean).join(" ").trim();if(t)return t;const r=[e.full_name,e.preferred_username,e.nickname,e.user_name,e.username,e.display_name].filter(Boolean);for(const n of r){const e=String(n).trim();if(e&&!/^new\s+user$/i.test(e))return e}return"User"})()]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-3 sm:gap-0 sm:space-x-2 relative sm:flex-1 sm:justify-center",children:[e.jsxs("button",{onClick:()=>S(!C),className:"bg-gradient-to-r from-slate-800 to-slate-900 dark:from-slate-700 dark:to-slate-800 text-white px-4 sm:px-6 py-3 rounded-xl text-xs sm:text-sm font-medium hover:from-slate-900 hover:to-slate-950 dark:hover:from-slate-600 dark:hover:to-slate-700 transition-all duration-300 w-full sm:w-auto shadow-sm hover:shadow-md",children:["Question ",h+1," of ",v.questions.length,e.jsx("span",{className:"material-icons text-sm align-middle",children:"arrow_drop_down"})]}),C&&e.jsx("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-lg shadow-xl w-[300px] sm:w-[420px] border border-gray-200 dark:border-gray-700 max-h-96 overflow-y-auto transition-colors duration-300",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 sm:mb-6",children:[e.jsxs("h1",{className:"text-base sm:text-lg font-semibold text-gray-800 dark:text-white transition-colors duration-300",children:["Quiz ",v?.quizNumber??"N/A"]}),e.jsx("button",{onClick:()=>S(!1),className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors duration-300",children:e.jsx("span",{className:"material-icons",children:"close"})})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-4 mb-4 sm:mb-6 pb-4 border-b border-gray-300 dark:border-gray-600 transition-colors duration-300 text-xs",children:[e.jsxs("div",{className:"flex items-center text-gray-700 dark:text-gray-300 transition-colors duration-300",children:[e.jsx("span",{className:"material-icons text-base mr-2 text-blue-600",children:"location_on"}),e.jsx("span",{children:"Current"})]}),e.jsxs("div",{className:"flex items-center text-gray-700 dark:text-gray-300 transition-colors duration-300",children:[e.jsx("span",{className:"material-icons text-base mr-2 text-gray-400",children:"check_box_outline_blank"}),e.jsx("span",{children:"Unanswered"})]}),e.jsxs("div",{className:"flex items-center text-gray-700 dark:text-gray-300 transition-colors duration-300",children:[e.jsx("span",{className:"material-icons text-base mr-2 text-red-500",children:"bookmark"}),e.jsx("span",{children:"For Review"})]})]}),e.jsx("div",{className:"grid grid-cols-6 sm:grid-cols-8 gap-1 mb-4 sm:mb-6 p-2",children:v.questions.map((t,r)=>{const n=p[t.id],s=r===h,o=N.has(t.id);return e.jsx("div",{onClick:()=>(e=>{f(e),S(!1)})(r),className:`question-box cursor-pointer ${s?"current":""} ${n?"answered":""} ${o?"flagged":""}`,style:{transition:"none",minHeight:"32px",fontSize:"12px"},children:e.jsx("span",{className:"font-medium text-xs "+(n?"text-white dark:text-gray-800":s?"text-white":"text-gray-600 dark:text-gray-300"),children:r+1})},r)})}),e.jsx("button",{onClick:()=>{S(!1),R(!0)},className:"w-full py-2 px-3 bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 border border-blue-600 dark:border-blue-400 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 transition duration-150 ease-in-out text-xs sm:text-sm",children:"Go to Review Page"})]})})]}),e.jsxs("div",{className:"flex items-center space-x-2 w-full sm:w-auto sm:flex-1 sm:justify-end",children:[e.jsx("button",{onClick:()=>f(Math.max(0,h-1)),disabled:0===h,className:"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 px-4 sm:px-6 py-3 rounded-xl text-xs sm:text-sm font-medium hover:bg-slate-200 dark:hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 flex-1 sm:flex-initial shadow-sm hover:shadow-md",children:"Back"}),e.jsx("button",{onClick:()=>{h===v.questions.length-1?R(!0):f(h+1)},className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-4 sm:px-6 py-3 rounded-xl text-xs sm:text-sm font-medium hover:from-blue-700 hover:to-blue-800 transition-all duration-300 flex-1 sm:flex-initial shadow-sm hover:shadow-md transform hover:scale-105",children:"Next"})]})]}),e.jsx("div",{className:"flex w-full flex-shrink-0",children:v.questions.map((t,r)=>e.jsx("div",{className:`progress-bar-segment ${Be(r)}`},r))}),W.show&&e.jsx(l,{pointsAwarded:W.points,actionType:W.action,onComplete:Ae}),e.jsx(c,{isOpen:se.isOpen,imageSrc:se.imageSrc,imageAlt:se.imageAlt,onClose:()=>{oe({isOpen:!1,imageSrc:"",imageAlt:""})}}),M&&e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/60 backdrop-blur-sm",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-700 p-8 max-w-md w-full mx-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Saving Quiz Progress"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Please wait while we save your progress..."})]})})}),O&&e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/60 backdrop-blur-sm",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-700 p-8 max-w-md w-full mx-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Completing Quiz"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Please wait while we process your results..."})]})})})]}):e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading quiz..."})})};export{x as default};
